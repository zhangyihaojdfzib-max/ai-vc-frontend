---
title: AlphaChip：用强化学习变革芯片设计，加速谷歌TPU研发
title_original: How AlphaChip transformed computer chip design
date: '2024-09-26'
source: Google DeepMind
source_url: https://deepmind.google/blog/how-alphachip-transformed-computer-chip-design/
author: ''
summary: 本文介绍了谷歌发布的AlphaChip，这是一种基于强化学习的AI方法，用于自动化并优化计算机芯片的布局设计。该方法将芯片布局视为一种“游戏”，通过图神经网络学习元件关系，能在数小时内生成超越人类专家水平的布局，而传统方法需要数周或数月。自2020年发布以来，AlphaChip已成功应用于谷歌三代定制AI加速器（TPU）的设计中，显著缩短了设计周期并提升了芯片性能。文章还宣布开源了预训练模型权重，并发布了更详细的技术增刊。
categories:
- AI研究
tags:
- 芯片设计
- 强化学习
- 人工智能
- 谷歌
- TPU
draft: false
translated_at: '2026-02-12T04:22:24.484072'
---

# AlphaChip 如何变革计算机芯片设计

安娜·戈尔迪 与 阿扎莉亚·米尔霍塞尼

我们的人工智能方法加速并优化了芯片设计，其超人类的芯片布局已在全球硬件中得到应用

2020年，我们发布了一篇预印本，介绍了我们用于设计芯片布局的新型强化学习方法，该方法后来发表在《自然》杂志上并进行了开源。

今天，我们正在发布一篇《自然》增刊，更详细地阐述了我们的方法及其对芯片设计领域的影响。同时，我们发布了一个预训练检查点，共享模型权重，并宣布其名称：AlphaChip。

计算机芯片推动了人工智能（AI）的显著进步，而 AlphaChip 则通过利用 AI 来加速和优化芯片设计，回馈了这一领域。自 2020 年发布以来，该方法已被用于设计过去三代谷歌定制 AI 加速器——张量处理单元（TPU）中的超人类芯片布局。

AlphaChip 是最早用于解决现实世界工程问题的强化学习方法之一。它能在数小时内生成超人类或同等水平的芯片布局，而无需耗费人类数周或数月的时间。其布局已被应用于全球范围内的芯片中，从数据中心到移动设备。

AlphaChip 突破性的 AI 方法彻底变革了芯片设计的一个关键阶段。

## AlphaChip 的工作原理

设计芯片布局并非易事。计算机芯片由许多相互连接的模块组成，包含多层电路元件，所有元件都由极其细微的导线连接。同时，还存在大量复杂且相互交织的设计约束需要同时满足。由于其极高的复杂性，六十多年来，芯片设计师们一直难以实现芯片布局规划过程的自动化。

类似于学会掌握围棋、国际象棋和将棋的 AlphaGo 和 AlphaZero，我们构建 AlphaChip 时将芯片布局规划视为一种游戏。

从一个空白网格开始，AlphaChip 一次放置一个电路元件，直到放置完所有元件。然后，根据最终布局的质量给予其奖励。一种新颖的“基于边”的图神经网络使 AlphaChip 能够学习互连芯片元件之间的关系，并在不同芯片间进行泛化，从而让 AlphaChip 随着设计的每个布局而不断改进。

![左图：动画显示 AlphaChip 在无先验经验的情况下放置开源 Ariane RISC-V CPU。右图：动画显示 AlphaChip 在练习了 20 个与 TPU 相关的设计后放置同一模块。](/images/posts/f0186397c8b8.jpg)

![](/images/posts/4bf21547fada.jpg)

左图：动画显示 AlphaChip 在无先验经验的情况下放置开源 Ariane RISC-V CPU。右图：动画显示 AlphaChip 在练习了 20 个与 TPU 相关的设计后放置同一模块。

## 利用 AI 设计谷歌的 AI 加速器芯片

自 2020 年发布以来，AlphaChip 已为谷歌每一代 TPU 生成了超人类的芯片布局。这些芯片使得基于谷歌 Transformer 架构的大规模扩展 AI 模型成为可能。

TPU 是我们强大的生成式 AI 系统的核心，从大语言模型（如 Gemini）到图像和视频生成器（如 Imagen 和 Veo）。这些 AI 加速器也是谷歌 AI 服务的核心，并通过谷歌云提供给外部用户使用。

![谷歌数据中心中一排 Cloud TPU v5p AI 加速器超级计算机。](/images/posts/5da5cadff611.jpg)

谷歌数据中心中一排 Cloud TPU v5p AI 加速器超级计算机。

为了设计 TPU 布局，AlphaChip 首先在来自前几代的各种芯片模块上进行练习，例如片上及片间网络模块、内存控制器和数据传输缓冲区。这个过程称为预训练。然后，我们在当前的 TPU 模块上运行 AlphaChip 以生成高质量的布局。与先前的方法不同，AlphaChip 在解决更多芯片布局任务实例时会变得更好、更快，类似于人类专家的做法。

在每一代新的 TPU 中，包括我们最新的 Trillium（第六代），AlphaChip 都设计了更好的芯片布局，并提供了更多的整体布局规划，从而加速了设计周期并产生了性能更高的芯片。

![条形图显示 AlphaChip 在谷歌三代张量处理单元（TPU）中设计的芯片模块数量，包括 v5e、v5p 和 Trillium。](/images/posts/869e308f4f60.jpg)

条形图显示 AlphaChip 在谷歌三代张量处理单元（TPU）中设计的芯片模块数量，包括 v5e、v5p 和 Trillium。

![条形图显示 AlphaChip 在谷歌三代张量处理单元（TPU）中，与 TPU 物理设计团队生成的布局相比，平均线长减少的情况。](/images/posts/2f9b805aebcb.jpg)

条形图显示 AlphaChip 在谷歌三代张量处理单元（TPU）中，与 TPU 物理设计团队生成的布局相比，平均线长减少的情况。

## AlphaChip 的更广泛影响

AlphaChip 的影响体现在其在 Alphabet、研究社区和芯片设计行业的广泛应用中。除了设计像 TPU 这样的专用 AI 加速器外，AlphaChip 还为 Alphabet 的其他芯片生成了布局，例如谷歌 Axion 处理器——我们首款基于 Arm 架构的通用数据中心 CPU。

外部组织也在采用并基于 AlphaChip 进行构建。例如，全球顶级芯片设计公司之一的联发科扩展了 AlphaChip，以加速其最先进芯片的开发，同时改善功耗、性能和芯片面积。

AlphaChip 引发了 AI 用于芯片设计工作的爆炸式增长，并已扩展到芯片设计的其他关键阶段，如逻辑综合和宏单元选择。

AlphaChip 激发了一条全新的、针对芯片设计的强化学习研究路线，贯穿从逻辑综合到布局规划、时序优化及更远的设计流程。

## 创造未来的芯片

我们相信 AlphaChip 有潜力优化芯片设计周期的每个阶段，从计算机架构到制造——并变革日常设备（如智能手机、医疗设备、农业传感器等）中定制硬件的芯片设计。

AlphaChip 的未来版本正在开发中，我们期待与社区合作，继续革新这一领域，并带来芯片更快、更便宜、更节能的未来。

AlphaChip 突破性的 AI 方法彻底变革了芯片设计的一个关键阶段。在联发科，我们通过扩展这项技术并结合行业最佳实践，一直在引领芯片设计的布局规划和宏单元放置。这种范式转变不仅提高了设计效率，还为有效性设定了新的基准，推动行业走向未来的突破。

AlphaChip 展示了强化学习在应对最复杂的硬件优化挑战之一——芯片布局规划方面的巨大变革潜力。这项研究不仅将强化学习的应用从其在游戏场景中已确立的成功扩展到实际、高影响力的工业挑战，而且为在 AI 与全栈芯片设计交叉领域评估未来进展建立了一个稳健的基准环境。这项工作的长期影响是深远的，它说明了如何将艰巨的工程任务重新定义为 AI 驱动优化在半导体技术中的新途径。

AlphaChip激发了一条全新的芯片设计强化学习研究路线，贯穿从逻辑综合到布局规划、时序优化乃至更广泛的设计流程。虽然具体细节各异，但论文中的核心思想——包括辅助引导在线搜索的预训练Agent（智能体）以及基于图网络的电路表示方法——持续影响着该领域，包括我本人在逻辑综合强化学习方面的研究。即便尚未被公认，这项工作也注定将成为硬件设计机器学习领域的里程碑式论文之一。

强化学习已深刻影响了电子设计自动化领域，尤其是在应对AI驱动方法中数据稀缺的挑战方面。尽管存在奖励延迟、泛化能力有限等障碍，研究已证明强化学习在布局规划等复杂电子设计自动化任务中的能力。这篇开创性论文已成为强化学习-电子设计自动化研究的基石，并被广泛引用，包括我本人在2023年ACM设计自动化会议上获得最佳论文奖的研究。

在现代时代，有两股力量正发挥着关键作用：半导体芯片设计与人工智能。这项研究开辟了新路径，并展示了让电子设计自动化社区认识到AI和强化学习在集成电路设计中威力的理念。它对芯片设计AI领域产生了开创性影响，并对我们推动建立IEEE LLM-Aided Design（LAD）这类重要研究会议以探讨此类具有影响力的想法，起到了至关重要的启发作用。

我们衷心感谢杰出的合著者们：Mustafa Yazgan、Joe Wenjie Jiang、Ebrahim Songhori、Shen Wang、Young-Joon Lee、Eric Johnson、Omkar Pathak、Azade Nazi、Jiwoo Pak、Andy Tong、Kavya Srinivasa、William Hang、Emre Tuncer、Quoc V. Le、James Laudon、Richard Ho、Roger Carpenter和Jeff Dean。

我们特别感谢Joe Wenjie Jiang、Ebrahim Songhori、Young-Joon Lee、Roger Carpenter和Sergio Guadarrama为达成此项实际影响所做的持续努力，感谢Quoc V. Le的研究建议与指导，以及我们的资深作者Jeff Dean的支持与深入技术探讨。

我们还要感谢Ed Chi、Zoubin Ghahramani、Koray Kavukcuoglu、Dave Patterson和Chris Manning提供的所有建议与支持。

### MuZero、AlphaZero与AlphaDev：优化计算机系统

![](/images/posts/2d4c2597746e.jpg)

### Gemini

![](/images/posts/6fb7609fe932.jpg)

### Imagen

![](/images/posts/4b344bd7f86f.jpg)

![](/images/posts/f69eb1993306.jpg)

---

> 本文由AI自动翻译，原文链接：[How AlphaChip transformed computer chip design](https://deepmind.google/blog/how-alphachip-transformed-computer-chip-design/)
> 
> 翻译时间：2026-02-12 04:22
