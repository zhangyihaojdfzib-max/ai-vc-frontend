---
title: DeepAgents推出远程沙盒，安全执行任意Agent代码
title_original: Execute Code with Sandboxes for DeepAgents
date: '2025-11-13'
source: LangChain Blog
source_url: https://blog.langchain.com/execute-code-with-sandboxes-for-deepagents/
author: LangChain
summary: 本文介绍了DeepAgents新推出的沙盒功能，该功能允许用户在远程隔离环境中安全执行任意DeepAgent代码。文章阐述了沙盒在安全性、环境纯净性、并行执行、长时间任务和可复现性方面的优势，详细说明了其三步工作原理，并提供了使用Runloop、Daytona和Modal三家合作伙伴沙盒的入门指南。同时，文章还强调了安全使用沙盒的注意事项，并给出了一个示例设置脚本，帮助用户配置环境变量和克隆代码仓库。
categories:
- AI基础设施
tags:
- DeepAgents
- 沙盒
- 代码安全
- AI开发工具
- 远程执行
draft: false
translated_at: '2026-01-06T01:12:11.890Z'
---

作者：Vivek Trivedy

今天，我们很高兴推出 DeepAgents 沙盒，这是一套全新的集成工具，允许您在远程沙盒中安全地执行任意 DeepAgent 代码。目前，我们支持来自三家合作伙伴的沙盒：Runloop、Daytona 和 Modal。下面，我们将深入探讨沙盒的功能以及如何通过 DeepAgents-CLI 使用它们。

**为什么我们需要沙盒？**

沙盒为我们提供了一个简单、可配置的环境，用于在本地机器之外执行代码和工作。以下是一些可能适用的场景：
- **安全性**：您的 Agent（智能体）可能执行对本地机器有害的任意代码（例如：`rm -rf`）。在沙盒中运行意味着您的机器可以免受潜在恶意代码的侵害。
- **纯净环境**：您需要特定的依赖项、语言或操作系统配置，但又不想污染本地环境。只需启动一个完全符合您需求的沙盒，使用它，然后将其终止。
- **并行执行**：同时运行多个 Agent（智能体），每个都在其独立的隔离环境中，避免资源冲突或相互干扰。
- **长时间运行的任务**：让 Agent（智能体）处理耗时的操作，而不会阻塞您的本地机器。
- **可复现性**：确保团队内部执行环境的一致性。

**工作原理**

沙盒集成主要包含三个步骤：
- 设置沙盒（可使用可选的设置脚本）
- Agent（智能体）希望执行一个命令
- 远程沙盒运行该命令并将结果返回给用户

您的 DeepAgent 在本地（或您希望的任何地方）运行，但当它需要执行代码、创建文件或运行命令时，这些操作会在远程沙盒中进行。Agent（智能体）对沙盒文件系统和命令输出保持完全的可见性，因此可以自然地迭代。设置脚本可用于加载环境变量、克隆 git 仓库、准备环境等。

**如何开始使用**

要使用 Daytona 和 Runloop 沙盒，只需创建一个账户并将 API 密钥存储为环境变量（`DAYTONA_API_KEY` 和 `RUNLOOP_API_KEY`）。要使用 Modal 沙盒，请按照[此处](https://modal.com/docs/guide)的安装说明操作并运行 `modal setup`。

完成设置后，DeepAgents CLI 提供了简单的命令，让您能在几分钟内通过便捷的 `sandbox` 和 `sandbox-setup` 命令开始使用沙盒。

> 注意：我们提供了上下文管理器来自动清理沙盒，但我们建议您检查提供商的控制面板，以确保没有 Agent（智能体）或沙盒意外地仍在运行。

例如，以下命令可用于将位于当前目录的自定义设置脚本附加到您的 DeepAgent，以连接一个 runloop 沙盒：
```
uvx deepagents-cli --sandbox runloop --sandbox-setup ./setup.sh
```

> **注意：安全使用沙盒**
> 虽然沙盒是隔离的，但在处理不受信任的输入时，Agent（智能体）仍然容易受到提示词注入攻击。为了降低沙盒中存在机密信息的风险，我们建议运行可信的设置脚本、采用人在回路机制以及分配短期有效的密钥。沙盒 API 正在快速发展，我们预计会有更多提供商支持有助于缓解提示词注入和机密信息管理问题的代理。

以下是一个简单设置脚本的示例，它将本地环境变量（如 GitHub token 或 OpenAI key）添加到沙盒中，并拉取一个仓库。运行此脚本的前提是您的本地 `.env` 文件包含所需的密钥和令牌：
```
#!/bin/bash
set -e # 任何错误时退出
echo "Configuring sandbox environment..."
# 1. 使用 GitHub token 克隆您的仓库
echo "Cloning repository..."
git clone <https://x-access-token:${GITHUB_TOKEN}@github.com/username/repo.git> $$HOME/workspace
cd $$HOME/workspace
echo "✓ Repository cloned"
# 2. 为所有后续命令设置持久化环境变量
echo "Setting up environment variables..."
cat >> ~/.bashrc <<'EOF'
# 从本地添加选定的环境变量到沙盒
export GITHUB_TOKEN="${GITHUB_TOKEN}"
export FAL_API_KEY="${FAL_API_KEY}"
# 自动导航到工作空间
cd $$HOME/workspace
EOF
# 3. 激活环境
source ~/.bashrc
echo "✓ Environment configured"
```

**下一步是什么？**

我们期待看到开发者们如何将沙盒与他们的 DeepAgents 结合使用。我们将为沙盒添加更多配置选项，并分享更多关于集成沙盒以完成实际工作的示例。

如果您想观看关于如何开始使用沙盒的教程，请查看我们的[教程](https://deepagents.ai/tutorials/sandboxes)。

准备好开始构建了吗？立即开始使用我们的 [DeepAgents 文档](https://docs.deepagents.ai) 和 [GitHub 仓库](https://github.com/deepagents)。


> 本文由AI自动翻译，原文链接：[Execute Code with Sandboxes for DeepAgents](https://blog.langchain.com/execute-code-with-sandboxes-for-deepagents/)
> 
> 翻译时间：2026-01-06 01:12
