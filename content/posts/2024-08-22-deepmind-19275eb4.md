---
title: FermiNet：基于深度学习的量子化学第一性原理计算
title_original: 'FermiNet: Quantum physics and chemistry from first principles'
date: '2024-08-22'
source: Google DeepMind
source_url: https://deepmind.google/blog/ferminet-quantum-physics-and-chemistry-from-first-principles/
author: ''
summary: 本文介绍了DeepMind开发的FermiNet神经网络架构，这是首个通过深度学习基于第一性原理计算原子和分子能量，并达到实用精度水平的方法。文章阐述了如何运用深度学习解决计算量子化学的基础问题，探索物质与光的相互作用，并回顾了量子力学简史。FermiNet旨在模拟大量电子的量子态，为新材料和化学合成过程的计算机模拟原型设计提供可能，代表了人工智能工具解决基础科学问题的重要进展。
categories:
- AI研究
tags:
- 深度学习
- 量子化学
- 第一性原理计算
- FermiNet
- 人工智能研究
draft: false
translated_at: '2026-02-14T04:11:07.548432'
---

# FermiNet：基于第一性原理的量子物理与化学研究

David Pfau 与 James Spencer

![彩虹色原子抽象图像](/images/posts/e1aca75219c0.jpg)

注：本文最初发布于2020年10月19日。随着我们关于激发态研究的突破性成果于2024年8月22日在《科学》杂志发表，我们进行了小幅更新，并在下方新增了关于此新研究阶段的章节。

## 运用深度学习解决计算量子化学基础问题并探索物质与光的相互作用

在发表于《物理评论研究》的[文章](https://journals.aps.org/prresearch/abstract/10.1103/PhysRevResearch.2.033429)中，我们展示了深度学习如何帮助求解真实世界系统的量子力学基本方程。这不仅是一个重要的基础科学问题，未来还可能带来实际应用，使研究人员能够在实验室尝试合成之前，通过计算机模拟来原型设计新材料和化学合成过程。

我们的神经网络架构——**FermiNet**（费米子神经网络），非常适合模拟大量电子的量子态（化学键的基本构成单元）。我们已公开[此项研究的代码](https://github.com/deepmind/deepmind-research/tree/master/ferminet)，以便计算物理和化学界能在我们工作的基础上，将其应用于更广泛的问题。

FermiNet 是首个通过深度学习基于第一性原理计算原子和分子能量，且精度达到实用水平的示范；而我们基于自注意力机制的新颖架构——**Psiformer**，至今仍是最精确的人工智能方法。

我们希望人工智能（AI）研究中开发的工具和思想能帮助解决基础科学问题。FermiNet 与我们关于[蛋白质折叠](https://deepmind.google/discover/blog/alphafold-a-solution-to-a-50-year-old-grand-challenge-in-biology/)、[玻璃态动力学](https://deepmind.google/discover/blog/using-ai-to-uncover-the-mystery-of-glasses/)、[晶格量子色动力学](https://deepmind.google/discover/blog/using-machine-learning-to-accelerate-scientific-progress/)以及许多其他项目的工作一道，正将这一愿景变为现实。

## 量子力学简史

提及“量子力学”，你更可能引发的是困惑而非其他。这个短语会让人联想到既死又活的[薛定谔的猫](https://en.wikipedia.org/wiki/Schr%C3%B6dinger%27s_cat)，以及本质上也是波的基本粒子。

在量子系统中，像电子这样的粒子并不像经典描述中那样具有确切的位置。相反，其位置由概率云描述——它在所有允许存在的位置上“弥散”开来。这种反直觉的状态使得理查德·费曼宣称：“如果你认为你理解量子力学，那你就不理解量子力学。”

尽管存在这种诡异的奇特性，该理论的核心可以简化为几个直接的方程。其中最著名的是**薛定谔方程**，它描述了量子尺度下粒子的行为，正如[牛顿运动定律](https://en.wikipedia.org/wiki/Newton%27s_laws_of_motion)描述我们更熟悉的人类尺度下物体的行为一样。虽然对这个方程的解释可能引发无尽的挠头思考，但其数学处理却要容易得多，这导致教授们在面对学生棘手的哲学问题时，常会劝诫他们“闭嘴，只管计算”。

这些方程足以在原子和原子核层面描述我们周围所有常见物质的行为。它们的反直觉本质导致了各种奇异现象：超导体、超流体、激光器和半导体都只因量子效应才成为可能。但即便是普通的**共价键**——化学的基本构建单元——也是电子量子相互作用的结果。

一旦这些规则在20世纪20年代被阐明，科学家们意识到，他们首次拥有了关于化学如何运作的详细理论。原则上，他们可以为不同的分子建立这些方程，求解系统的能量，并找出哪些分子是稳定的，哪些反应会自发发生。但当他们坐下来实际计算这些方程的解时，发现只能精确求解最简单的原子（氢），其他几乎都不行。其他一切都太复杂了。

> 因此，大部分物理学和整个化学的数学理论所必需的基础物理定律已完全知晓，困难仅在于这些定律的精确应用会导致方程过于复杂而无法求解。因此，开发应用量子力学的近似实用方法变得非常必要。

许多人响应了狄拉克的号召，物理学家很快建立了能够近似描述分子键和其他化学现象定性行为的数学技术。这些方法始于对电子行为的近似描述，这可能在基础化学中已为人所熟悉。

在这种描述中，每个电子被分配到一个特定的**轨道**，该轨道给出了在原子核附近任意点找到单个电子的概率。每个轨道的形状又取决于所有其他轨道的平均形状。由于这种“平均场”描述将每个电子视为仅分配到一个轨道，它对电子实际行为的描述是非常不完整的。尽管如此，它足以以仅约0.5%的误差估算分子的总能量。

![原子轨道示意图。表面表示找到电子概率高的区域。蓝色区域波函数为正，紫色区域波函数为负。](/images/posts/8429bb87c1fc.jpg)

原子轨道示意图。表面表示找到电子概率高的区域。蓝色区域波函数为正，紫色区域波函数为负。

不幸的是，0.5%的误差对于实际工作的化学家来说仍然不够有用。分子键中的能量仅占系统总能量的极小部分，正确预测一个分子是否稳定通常可能仅取决于系统总能量的0.001%，或剩余“关联”能量的约0.2%。

例如，虽然[丁二烯分子](https://en.wikipedia.org/wiki/1,3-Butadiene)中电子的总能量接近每摩尔100,000千卡，但该分子不同可能形状之间的能量差仅为每摩尔1千卡。这意味着，如果你想正确预测丁二烯的自然形状，所需的精度相当于将足球场的宽度测量到毫米级。

随着二战后数字计算的出现，科学家们开发了多种超越这种电子平均场描述的计算方法。虽然这些方法缩写繁多，但它们通常都在一条权衡精度与效率的轴上占据某个位置。一端是本质上精确但随电子数量增长比指数更差的方法，使其除了最小分子外都不实用。另一端是线性扩展但不太准确的方法。这些计算方法对化学实践产生了巨大影响——[1998年诺贝尔化学奖](https://www.nobelprize.org/prizes/chemistry/1998/summary/)就授予了其中许多算法的创始人。

## 费米子神经网络

尽管现有的计算量子力学工具范围广泛，但我们认为需要一种新方法来解决高效表示的问题。即使对于最近似的方法，最大的量子化学计算也只能处理数万个电子，而像分子动力学这样的经典化学计算技术却能处理数百万个原子，这是有原因的。

经典系统的状态可以轻松描述——我们只需追踪每个粒子的位置和动量即可。而描述量子系统的状态则要困难得多。必须为电子位置的每一种可能构型分配概率。这被编码在波函数中，波函数为电子的每一种构型分配一个正数或负数，波函数的平方则给出了系统处于该构型的概率。

所有可能构型的空间是极其庞大的——如果你试图用一个沿每个维度有100个点的网格来表示它，那么硅原子的可能电子构型数量将超过宇宙中的原子总数。这正是我们认为深度神经网络可以发挥作用的地方。

过去几年，用神经网络表示复杂的高维概率分布取得了巨大进展。我们现在已经知道如何高效且可扩展地训练这些网络。我们推测，既然这些网络已经在人工智能问题中证明了其拟合高维函数的能力，或许它们也能用来表示量子波函数。

Giuseppe Carleo、Matthias Troyer 等研究人员已经展示了如何利用现代深度学习来解决理想化的量子问题。我们希望使用深度神经网络来处理化学和凝聚态物理中更现实的问题，这意味着我们的计算需要包含电子。

处理电子时有一个难点。电子必须遵守**泡利不相容原理**，这意味着它们不能同时处于同一空间。这是因为电子是一种被称为**费米子**的粒子，这类粒子包括了构成大多数物质的基本单元：质子、中子、夸克、中微子等。它们的波函数必须是反对称的。如果你交换两个电子的位置，波函数会乘以 -1。这意味着如果两个电子重叠在一起，波函数（以及该构型的概率）将为零。

这意味着我们必须开发一种对其输入具有反对称性的新型神经网络，我们称之为 FermiNet。在大多数量子化学方法中，反对称性是通过一个称为行列式的函数引入的。矩阵的行列式具有这样的性质：如果你交换两行，输出会乘以 -1，就像费米子的波函数一样。

因此，你可以取一堆单电子函数，为系统中的每个电子计算这些函数，并将所有结果打包到一个矩阵中。该矩阵的行列式就是一个具有正确反对称性的波函数。这种方法的主要局限在于，得到的函数——称为**斯莱特行列式**——通用性不强。

真实系统的波函数通常要复杂得多。改进的典型方法是取斯莱特行列式的一个大型线性组合——有时是数百万个甚至更多——并添加一些基于电子对的简单修正。即便如此，这可能仍不足以精确计算能量。

![斯莱特行列式动画。每条曲线都是上面所示某个轨道的切片。当电子1和2交换位置时，斯莱特行列式的行发生交换，波函数乘以 -1。这保证了泡利不相容原理得到遵守。](/images/posts/17c2286c45d6.jpg)

斯莱特行列式动画。每条曲线都是上面所示某个轨道的切片。当电子1和2交换位置时，斯莱特行列式的行发生交换，波函数乘以 -1。这保证了泡利不相容原理得到遵守。

深度神经网络在表示复杂函数方面，通常比基函数的线性组合高效得多。在 FermiNet 中，这是通过使进入行列式的每个函数都是所有电子的函数来实现的（见脚注）。这远远超出了仅使用单电子和双电子函数的方法。FermiNet 为每个电子设置了一个独立的信息流。如果这些流之间没有任何交互，那么网络的表达能力将不会超过传统的斯莱特行列式。

为了突破这一限制，我们在网络的每一层对所有流的信息进行平均，并将这些信息传递到下一层的每个流。这样，这些流就具备了创建反对称函数所需的正确对称性属性。这与**图神经网络**在每一层聚合信息的方式类似。

与斯莱特行列式不同，FermiNet 是**通用函数逼近器**，至少在神经网络层变得足够宽的情况下是如此。这意味着，如果我们能正确训练这些网络，它们应该能够拟合薛定谔方程的近乎精确解。

FermiNet 动画。网络的单个信息流（蓝色、紫色或粉色）的功能与传统轨道非常相似。FermiNet 在流之间引入了对称交互，使得波函数更加通用和富有表现力。就像传统的斯莱特行列式一样，交换两个电子的位置仍然会导致行列式中两行交换，并使总波函数乘以 -1。

我们通过最小化系统的能量来拟合 FermiNet。要做到精确，我们需要评估电子在所有可能构型下的波函数，因此我们只能近似地进行。我们随机选取一组电子构型，在每个电子排布处局部计算能量，将每个排布的贡献相加，并最小化这个总和而非真实能量。这被称为**蒙特卡洛方法**，因为它有点像赌徒反复掷骰子。虽然这是近似的，但如果我们需要提高精度，我们总是可以再次"掷骰子"。

由于波函数的平方给出了在任何位置观察到粒子排布的概率，最方便的方法是从波函数本身生成样本——本质上，就是模拟观察粒子的行为。虽然大多数神经网络是根据一些外部数据训练的，但在我们的情况下，用于训练神经网络的输入是由神经网络自身生成的。这意味着除了电子围绕运动的原子核位置外，我们不需要任何训练数据。

这个基本思想被称为变分量子蒙特卡洛（简称 VMC），自 60 年代就已存在，通常被认为是一种计算系统能量的廉价但不太精确的方法。通过用 FermiNet 取代基于斯莱特行列式的简单波函数，我们在所研究的每个系统上都极大地提高了这种方法的精度。

![从 FermiNet 中采样的模拟电子在双环丁烷分子周围运动。](/images/posts/c37b1e3009f9.jpg)

从 FermiNet 中采样的模拟电子在双环丁烷分子周围运动。

为了确保 FermiNet 代表了该领域技术的进步，我们首先研究了简单且经过充分研究的系统，比如元素周期表第一行的原子（从氢到氖）。这些都是小系统——10个或更少的电子——并且足够简单，可以用最精确（但呈指数级扩展）的方法处理。

FermiNet以显著优势超越了同类变分蒙特卡洛（VMC）计算——通常能将相对于指数级复杂度计算的误差降低一半甚至更多。对于更大的体系，指数级复杂度的方法变得难以处理，因此我们改用耦合簇方法作为基准。该方法对于处于稳定构型的分子效果良好，但在化学键被拉伸或断裂时表现不佳，而这对于理解化学反应至关重要。尽管其复杂度远低于指数级，但我们所使用的特定耦合簇方法仍以电子数的七次方规模增长，因此只能用于中等大小的分子。

我们将FermiNet应用于逐渐增大的分子，从氢化锂开始，一直到我们研究的最大体系——具有30个电子的双环丁烷。对于最小的分子，FermiNet惊人地捕捉到了耦合簇能量与单个斯莱特行列式能量之间差异的99.8%。对于双环丁烷，FermiNet仍能捕捉到97%或更多的相关能，这对于如此简单的方法而言是一项巨大成就。

![FermiNet在分子上捕捉的相关能比例图示。紫色条表示99%的相关能。从左至右：氢化锂、氮气、乙烯、臭氧、乙醇和双环丁烷。](/images/posts/0da85a5435f4.jpg)

FermiNet在分子上捕捉的相关能比例图示。紫色条表示99%的相关能。从左至右：氢化锂、氮气、乙烯、臭氧、乙醇和双环丁烷。

尽管耦合簇方法对于稳定分子效果良好，但计算化学的真正前沿在于理解分子如何拉伸、扭曲和断裂。在这方面，耦合簇方法往往力不从心，因此我们必须尽可能与多种基准方法进行比较，以确保获得一致的结果。

我们研究了两个基准拉伸体系：氮气分子（N₂）和具有10个原子的氢链（H₁₀）。氮气键尤其具有挑战性，因为每个氮原子贡献三个电子。而氢链对于理解材料中电子的行为（例如预测材料是否导电）具有重要意义。

在这两个体系上，耦合簇方法在平衡态时表现良好，但随着化学键被拉伸则出现问题。传统的VMC计算在所有情况下都表现不佳，但无论键长如何，FermiNet都是所研究的最佳方法之一。

## 计算激发态的新方法

2024年8月，我们在《科学》杂志上发表了这项工作的下一阶段研究成果。我们的研究为计算量子化学中最棘手的挑战之一——理解分子受激发时如何跃迁至激发态以及从激发态返回——提出了解决方案。

FermiNet最初专注于分子的基态，即给定原子核周围电子的最低能量构型。但当分子和材料受到大量能量激发时（如暴露于光或高温下），电子可能被激发到更高的能量构型——即激发态。

激发态对于理解物质与光的相互作用至关重要。吸收和释放的精确能量量为不同分子和材料创造了独特的"指纹"，影响着从太阳能电池板、LED到半导体、光催化剂等多种技术的性能。它们在涉及光的生物过程（如光合作用和视觉）中也起着关键作用。

精确计算激发态能量比计算基态能量更具挑战性。即使是基态化学的黄金标准方法（如耦合簇），在激发态上也显示出高达数十倍的误差。虽然我们希望将FermiNet的工作扩展到激发态，但现有方法对神经网络而言效果不足，无法与最先进的方法竞争。

我们开发了一种计算激发态的新方法，比先前的方法更稳健、更通用。我们的方法可应用于任何类型的数学模型，包括FermiNet和其他神经网络。其原理是通过寻找具有额外粒子的扩展体系的基态，从而只需极少修改即可使用现有的优化算法。

我们在广泛的基准测试中验证了这项工作，并取得了极具前景的结果。在一个名为碳二聚体的小型但复杂的分子上，我们实现了4 meV的平均绝对误差（MAE），这比先前达到20 meV的黄金标准方法更接近实验结果五倍。我们还在计算化学中一些最具挑战性的体系上测试了我们的方法（其中两个电子同时被激发），发现我们与迄今为止最严格、最复杂的计算结果相差约0.1 eV。

今天，我们开源了最新的研究成果，并希望研究界能在我们的方法基础上继续探索物质与光相互作用的未知方式。

致谢

我们关于激发态的新研究是与Ingrid von Glehn、Halvard Sutterud和Simon Axelrod共同完成的。

FermiNet由David Pfau、James S. Spencer、Alexander G. D. G. Matthews和W. M. C. Foulkes开发。

感谢Jess Valdez和Arielle Bier对博客的支持，以及Jim Kynvin、Adam Cain和Dominic Barlow提供的图表。

脚注

FermiNet还为每对电子设置了信息流，这些流中的信息会传回单电子流。为简洁起见，我们选择不在博客文章中可视化这部分，但详情可在论文中找到。

### 利用深度学习发现数百万种新材料

![](/images/posts/b5f0e67ae237.jpg)

### 利用AI在量子尺度模拟物质

![](/images/posts/6bbda216119a.jpg)

---

> 本文由AI自动翻译，原文链接：[FermiNet: Quantum physics and chemistry from first principles](https://deepmind.google/blog/ferminet-quantum-physics-and-chemistry-from-first-principles/)
> 
> 翻译时间：2026-02-14 04:11
