---
title: 通过内容协商为智能体提供Markdown友好页面
title_original: Making agent-friendly pages with content negotiation - Vercel
date: '2026-02-03'
source: Vercel Blog
source_url: https://vercel.com/blog/making-agent-friendly-pages-with-content-negotiation
author: ''
summary: 本文介绍了Vercel如何通过HTTP内容协商机制，为智能体（Agent）提供优化的Markdown格式内容。智能体在浏览网页时，通常不需要CSS、JavaScript等前端资源，而是需要结构清晰、Token效率高的纯文本。Vercel更新了其博客和更新日志页面，当检测到请求头中优先接受Markdown格式时，服务器会返回经过转换的Markdown版本，相比原始HTML可减少99.6%的有效载荷。文章还阐述了智能体如何通过Accept头部请求内容、性能优势以及专为智能体优化的站点地图实现方式。
categories:
- AI基础设施
tags:
- 内容协商
- 智能体优化
- Markdown
- Vercel
- Web性能
draft: false
translated_at: '2026-02-04T04:21:29.761692'
---

Agent（智能体）会浏览网页，但它们的阅读方式与人类不同。它们不需要CSS、客户端JavaScript或图像。所有这些标记都会占用它们的上下文窗口并消耗Token，却无法提供有用信息。Agent（智能体）需要的是干净、结构化的文本。

这就是我们更新博客和更新日志页面的原因——在为用户提供完整HTML和CSS体验的同时，也让Agent（智能体）能够获取Markdown格式内容。这通过内容协商机制实现，该HTTP机制允许服务器根据客户端请求为同一内容返回不同格式。无需重复内容或单独建站。

## Agent（智能体）如何请求内容

Agent（智能体）使用HTTP的`Accept`头部来指定其偏好的格式。例如Claude Code在抓取页面时会发送以下头部：

```
Accept: text/markdown, text/html, */*
```

通过将`text/markdown`置于首位，Agent（智能体）表明在可用时更倾向于获取Markdown而非HTML格式。许多Agent（智能体）正开始以这种方式明确表达对Markdown的偏好。

您可以通过curl命令进行测试：

```
curl https://vercel.com/blog/self-driving-infrastructure -H "accept: text/markdown"
```

我们的中间件会检查传入请求的`Accept`头部并检测这些偏好。当检测到Markdown偏好时，会将请求路由至Next.js路由处理器，该处理器将Contentful富文本内容转换为Markdown格式。

这种转换保留了内容的结构特性：代码块保持语法高亮标记，标题维持层级关系，链接功能完整保留。Agent（智能体）获得的信息与HTML版本完全相同，只是采用了优化Token效率的格式。

## 性能优势

典型的博客文章包含所有HTML、CSS和JavaScript后约为500KB，而相同内容的Markdown版本仅2KB——有效载荷大小减少99.6%。

对于在Token限制下运行的Agent（智能体）而言，更小的有效载荷意味着每次请求可以处理更多内容，并将预算用于实际信息而非标记符号。它们的工作速度更快，触发限制的频率更低。

我们通过`Next.js 16远程缓存`和共享slug保持HTML与Markdown版本的同步。当Contentful中的内容更新时，两个版本会同时刷新。

## Agent（智能体）如何发现可用内容

Agent（智能体）需要发现可用内容。我们实现了专为Agent（智能体）优化的Markdown站点地图，以结构化格式列出所有内容。该站点地图包含每篇文章的元数据：发布日期、内容类型以及HTML和Markdown版本的直接链接。这为Agent（智能体）提供了完整的信息地图，使其能根据需求选择最合适的格式。

想查看实际效果？在本页面URL末尾添加`.md`即可获取Markdown版本。

---

> 本文由AI自动翻译，原文链接：[Making agent-friendly pages with content negotiation - Vercel](https://vercel.com/blog/making-agent-friendly-pages-with-content-negotiation)
> 
> 翻译时间：2026-02-04 04:21
