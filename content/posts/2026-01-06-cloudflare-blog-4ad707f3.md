---
title: 委内瑞拉BGP路由泄露事件分析：技术失误而非恶意攻击
title_original: A closer look at a BGP anomaly in Venezuela
date: '2026-01-06'
source: Cloudflare Blog
source_url: https://blog.cloudflare.com/bgp-route-leak-venezuela/
author: ''
summary: 本文针对委内瑞拉AS8048（CANTV）发生的BGP路由泄露事件进行技术分析。文章首先解释了BGP路由泄露的基本概念及其对网络流量的影响，随后结合Cloudflare
  Radar数据指出，自12月初以来已发生11起由AS8048引发的路由泄露，影响了多个前缀。分析表明，这些异常更可能源于该ISP路由策略配置不当等常见技术问题，而非简报所推测的恶意情报收集行为。文章通过客户-提供商关系等BGP基础原理，论证了此次事件的技术本质。
categories:
- 技术趋势
tags:
- BGP
- 网络安全
- 路由泄露
- 网络基础设施
- 委内瑞拉
draft: false
---

# 深入解析委内瑞拉的一起BGP异常事件

- Bryton Herdes

![Bryton Herdes](/images/posts/edfba2eecaa3.jpg)

![](/images/posts/c6d8d495a47f.png)

随着美国逮捕委内瑞拉领导人尼古拉斯·马杜罗的新闻不断发酵，一份网络安全简报审查了Cloudflare Radar的数据，并注意到1月2日委内瑞拉发生的一起路由泄露事件。

我们对数据进行了深入分析。自12月初以来，已发生11起路由泄露事件，影响了多个前缀，泄露方均为AS8048。虽然无法确切断定事件当天发生了什么，但这种路由泄露模式表明，委内瑞拉一家主流互联网服务提供商（ISP）CANTV（AS8048）的网络，其路由导出和导入策略存在不足。换句话说，研究人员观察到的BGP异常更可能与ISP的技术实践不佳有关，而非恶意行为。

本文将简要讨论边界网关协议（BGP）和BGP路由泄露，然后深入分析观察到的异常及其可能的原因。

### 背景：BGP路由泄露

首先，让我们回顾一下什么是BGP路由泄露。BGP路由泄露会导致类似于在高速公路上走错出口的行为。虽然你最终可能仍能到达目的地，但路径可能会更慢，并带来在更直接的路径上不会出现的延迟。

RFC7908对路由泄露给出了正式定义，即“路由宣告的传播超出了其预期范围”。预期范围是通过网络之间的成对业务关系来定义的。网络之间的关系（在BGP中我们用自治系统来表示）可以是以下之一：

- 客户-提供商：客户付费给提供商网络，以连接其自身及其下游客户到互联网的其余部分。
- 对等-对等：两个网络决定免费（无需付费）相互交换流量，以及交换到彼此客户的流量。

在客户-提供商关系中，提供商将向客户宣告所有路由。而客户则只宣告其自身客户的路由以及直接源自其网络的路由。

在对等-对等关系中，每个对等体只向对方宣告其自身的路由及其下游客户的路由。

这些宣告有助于以预期的方式引导流量：从客户上行到提供商网络，可能穿过单个对等链路，然后可能下行到路径远端来自其提供商的客户。

一个遵循无谷路由规则的有效路径如下所示：

路由泄露是违反无谷路由规则的行为，即一个AS从提供商或对等体获取路由，并将其重新分发到另一个提供商或对等体。例如，BGP路径永远不应经过一个“山谷”，即流量上行到提供商，再下行到客户，然后又上行到另一个提供商。RFC7908定义了不同类型的路由泄露，但最简单的一种是类型1：客户在两个提供商网络之间发生的发夹式路由泄露。

在上图中，AS64505从其一个提供商获取路由，并将其重新分发到其另一个提供商。这是出乎意料的，因为我们知道提供商不应将其客户用作中间IP传输网络。AS64505作为一个比其提供商拥有更小骨干网和网络链路的小型网络，将会被流量淹没。这可能迅速产生重大影响。

### AS8048（CANTV）的路由泄露

现在我们已经回顾了BGP中路由泄露的概念，让我们来审视一下网络安全简报中假设的情况。该文章提请注意Cloudflare Radar上涉及AS8048的几起路由泄露异常。在该泄露事件的Radar页面上，我们看到以下信息：

我们看到泄露方AS是AS8048——即委内瑞拉国有电话和互联网服务提供商CANTV。我们观察到，路由从其一个提供商AS6762（意大利电信公司Sparkle）获取，然后被重新分发到AS52320（哥伦比亚网络服务提供商V.tal GlobeNet）。这无疑是一起路由泄露事件。

该简报暗示了“BGP恶作剧”，并推测此类泄露可能被用来收集对政府实体有用的情报。

虽然我们无法确定是什么导致了这次路由泄露，但我们的数据表明，其原因可能更为普通。这部分是因为BGP路由泄露一直在发生，并且始终是互联网的一部分——大多数情况下并非出于恶意原因。

为了了解更多，让我们仔细看看受影响的前缀和网络。泄露涉及的所有前缀都源自AS21980（委内瑞拉公司Dayco Telecom）：

正如简报作者所指出的，这些前缀也都属于同一个200.74.224.0/20子网。然而，比这更有趣的是，源网络AS21980与泄露网络AS8048之间的关系：AS8048是AS21980的提供商。

AS8048和AS21980之间的客户-提供商关系在Cloudflare Radar和bgp.tools的AS关系推断数据中均可见。我们还可以使用BGPKIT的monocle工具获取AS关系的置信度分数，如下所示：

```
~ monocle as2rel 8048 21980
Explanation:
- connected: % of 1813 peers that see this AS relationship
- peer: % where the relationship is peer-to-peer
- as1_upstream: % where ASN1 is the upstream (provider)
- as2_upstream: % where ASN2 is the upstream (provider)

Data source: https://data.bgpkit.com/as2rel/as2rel-latest.json.bz2

┌───────┬───────┬────────────┬──────┬─────────────┬─────────────────┐
│ asn1  │ asn2  │ connected  │ peer │ as1_upstream│ as2_upstream    │
├───────┼───────┼────────────┼──────┼─────────────┼─────────────────┤
│ 8048  │ 21980 │    9.9%    │ 0.6% │     9.4%    │ 0.0%            │
└───────┴───────┴────────────┴──────┴─────────────┴─────────────────┘
```

虽然只有9.9%的路由收集器看到这两个AS相邻，但几乎所有包含它们的路径都显示AS8048是AS21980的上游提供商，这意味着两者之间存在提供商-客户关系的置信度很高。

许多泄露的路由也大量使用了AS8048的前缀追加，这意味着当其他网络收到时，这些路由的吸引力可能较低。前缀追加是指客户或对等体在出站宣告中多次添加同一个AS，试图将流量从特定线路切换到另一条线路。例如，AS8048泄露期间的许多路径看起来像这样：“52320,8048,8048,8048,8048,8048,8048,8048,8048,8048,23520,1299,269832,21980”。

你可以看到AS8048在向AS52320的宣告中多次发送了其AS，因为通过BGP环路预防机制，路径实际上不会连续多次进出AS8048。一个未追加前缀的路径看起来会是这样：“52320,8048,23520,1299,269832,21980”。

如果AS8048是故意试图成为流量中间人（MITM），他们为何要让BGP通告的吸引力降低而非增强？此外，既然他们本就是下游AS的提供商，为何还要通过泄露前缀来尝试中间人攻击？这并不合理。

AS8048的泄露事件还以多个独立通告的形式出现，均发生在2026年1月2日UTC时间15:30至17:45之间，每次间隔约一小时，这表明他们可能遇到了网络问题，这些问题以路由策略故障或收敛性事故的形式显现。

值得注意的是，这些泄露事件始于美国对委内瑞拉军事打击的十二个多小时前。影响南美网络的泄露事件很常见，基于时间点或我所讨论的其他因素，我们没有理由相信此次泄露与几小时后马杜罗被捕事件有关。

实际上，回顾过去两个月，我们可以看到AS8048发生了大量类似泄露，这意味着这并非新的BGP异常现象：

从上方Cloudflare Radar路由泄露警报管道的历史记录可见，AS8048对类型1发夹式路由泄露并不陌生。仅从12月初至今，AS8048作为泄露方就发生了十一起路由泄露事件。

由此我们可以得出一个更无害的可能解释：AS8048可能对至少一个提供商AS52320配置了过于宽松的导出策略。因此，即使直接客户的BGP路由缺失，他们仍重新分发了属于客户的路由。例如，如果他们对AS52320的导出策略仅匹配IRR生成的前缀列表，而未匹配客户BGP社区标签，那么AS8048将通往AS6762的间接路径泄露回上游就说得通了。

这类策略错误可以通过RFC9234和仅对客户（OTC）属性得到显著改善——当所有路由厂商都支持时，它们能将BGP与客户-提供商及对等体角色更紧密地结合。关于RFC9234的更技术性细节，我将在后续博客文章中详述。

### 源验证与路径验证的区别

该通讯还指出Sparkle（AS6762）未实施RPKI（资源公钥基础设施）路由源验证（ROV）是“值得注意的”。尽管AS6762确实存在不完整的ROV部署，并因此在isbgpsafeyet.com上被标记为“不安全”，但源验证本无法阻止这次委内瑞拉的BGP异常事件。

将BGP异常分为两类至关重要：路由源错误和基于路径的异常。了解两者的区别有助于理解各自的解决方案。路由源错误（常称为BGP劫持）应通过RPKI路由源验证（ROV）来修复，以确保前缀的发起方是合法所有者。而在本文描述的BGP异常案例中，源AS是正确的（AS21980），仅路径存在异常。这意味着ROV在此处无能为力。

有鉴于此，我们需要基于路径的验证。这正是即将成为IETF标准草案的自治系统提供商授权（ASPA）将要提供的功能。其理念类似于RPKI路由源授权（ROA）和ROV：创建一个ASPA对象来定义本AS的授权提供商（上游）列表，所有人将利用此列表在互联网的不同观测点使路由泄露失效。具体来说，AS6762是一个无层级一级传输网络，他们将在其ASPA签名对象中使用特殊保留的“AS0”成员向全球宣告他们没有上游提供商，只有对等体和客户。这样，AS8048的另一提供商AS52320就会在路径中看到来自其客户且包含“6762”的路由，并通过执行ASPA验证过程予以拒绝。

ASPA基于RPKI，正是能帮助预防类似我们在委内瑞拉观测到的路由泄露的技术。

### 共同构建更安全的BGP

我们认为有必要对Cloudflare Radar观测到的委内瑞拉AS8048 BGP路由泄露事件提供另一种解释。理解路由泄露是BGP历来完全基于信任和精心执行的商业关系驱动意图的预期副作用，这很有帮助。

尽管路由泄露可能出于恶意，但数据表明本次事件可能是因缺乏能防止泄露的路由导出和导入策略而导致的意外。正因如此，为了拥有更安全的BGP和互联网，我们需要共同努力，推动基于RPKI的ASPA在广阔互联网上的采用——RIPE近期已发布了对象创建功能。这将是一项协作努力，就像RPKI在源验证方面的推广一样，但这一切都是值得的，并能预防类似委内瑞拉的BGP事件。

除了ASPA，我们作为运营商都可以实施更简单的机制，例如Peerlock和Peerlock-lite，它们会对接收到的路径进行合理性检查以发现明显泄露。一项特别有前景的举措是采用RFC9234，它应与ASPA结合使用，通过建立BGP角色和新的仅对客户（OTC）属性来预防路由泄露。如果您尚未要求您的路由厂商将RFC9234的实现纳入其路线图：请务必提出。您可以帮助带来重大改变。

---

> 本文由AI自动翻译，原文链接：[A closer look at a BGP anomaly in Venezuela](https://blog.cloudflare.com/bgp-route-leak-venezuela/)
> 
> 翻译时间：2026-01-07 02:45
