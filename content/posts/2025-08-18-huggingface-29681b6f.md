---
title: ä»é›¶æ„å»ºç”Ÿäº§çº§CUDAæ ¸å‡½æ•°ï¼šå¼€å‘ä¸éƒ¨ç½²æŒ‡å—
title_original: 'From Zero to GPU: A Guide to Building and Scaling Production-Ready
  CUDA Kernels'
date: '2025-08-18'
source: Hugging Face Blog
source_url: https://huggingface.co/blog/kernel-builder
author: ''
summary: æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•åˆ©ç”¨`kernel-builder`åº“ï¼Œä»é›¶å¼€å§‹æ„å»ºå¹¶éƒ¨ç½²ç”Ÿäº§å°±ç»ªçš„CUDAæ ¸å‡½æ•°ã€‚æ–‡ç« ä»¥å›¾åƒRGBè½¬ç°åº¦æ ¸å‡½æ•°ä¸ºä¾‹ï¼Œè¯¦ç»†é˜è¿°äº†ç°ä»£CUDAé¡¹ç›®çš„ç»“æ„è®¾è®¡ã€é…ç½®æ–‡ä»¶ç¼–å†™ã€å¯é‡å¤æ„å»ºç¯å¢ƒé…ç½®ä»¥åŠæ ¸å¿ƒCUDAä»£ç å¼€å‘ã€‚é‡ç‚¹è§£å†³äº†ä»æœ¬åœ°å¼€å‘åˆ°å¤šæ¶æ„æ„å»ºã€å†åˆ°å…¨çƒåˆ†å‘çš„å®Œæ•´å·¥ä½œæµï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…åˆ›å»ºé«˜æ•ˆã€å¥å£®ä¸”æ˜“äºç»´æŠ¤çš„GPUåŠ é€Ÿç³»ç»Ÿã€‚
categories:
- AIåŸºç¡€è®¾æ–½
tags:
- CUDA
- GPUç¼–ç¨‹
- é«˜æ€§èƒ½è®¡ç®—
- PyTorch
- éƒ¨ç½²
draft: false
translated_at: '2026-02-14T04:14:50.060547'
---

# ä»é›¶åˆ°GPUï¼šæ„å»ºä¸æ‰©å±•ç”Ÿäº§å°±ç»ªCUDAæ ¸å‡½æ•°çš„æŒ‡å—

è‡ªå®šä¹‰CUDAæ ¸å‡½æ•°èƒ½ä¸ºæ‚¨çš„æ¨¡å‹å¸¦æ¥æ˜¾è‘—çš„æ€§èƒ½ä¼˜åŠ¿ï¼Œä½†ä¸ºå®é™…åº”ç”¨æ„å»ºå®ƒä»¬å¯èƒ½ä»¤äººæœ›è€Œç”Ÿç•ã€‚å¦‚ä½•è¶…è¶Šç®€å•çš„GPUå‡½æ•°ï¼Œåˆ›å»ºå¥å£®ã€å¯æ‰©å±•çš„ç³»ç»Ÿï¼ŒåŒæ—¶é¿å…é™·å…¥æ— å°½çš„æ„å»ºæ—¶é—´å’Œä¾èµ–å…³ç³»å›°å¢ƒï¼Ÿ

ä¸ºæ­¤æˆ‘ä»¬åˆ›å»ºäº†`kernel-builder`åº“ã€‚æ‚¨å¯ä»¥åœ¨æœ¬åœ°å¼€å‘è‡ªå®šä¹‰æ ¸å‡½æ•°ï¼Œç„¶åä¸ºå¤šç§æ¶æ„æ„å»ºå®ƒï¼Œå¹¶ä½¿å…¶å¯ä¾›å…¨çƒä½¿ç”¨ã€‚

åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä»å¤´å¼€å§‹æ„å»ºä¸€ä¸ªå®Œæ•´çš„ç°ä»£CUDAæ ¸å‡½æ•°ã€‚æ¥ç€ï¼Œæˆ‘ä»¬å°†è§£å†³æ£˜æ‰‹çš„ç”Ÿäº§å’Œéƒ¨ç½²æŒ‘æˆ˜ï¼Œå€Ÿé‰´å®é™…å·¥ç¨‹ç­–ç•¥ï¼Œå‘æ‚¨å±•ç¤ºå¦‚ä½•æ„å»ºä¸ä»…å¿«é€Ÿï¼Œè€Œä¸”é«˜æ•ˆä¸”å¯ç»´æŠ¤çš„ç³»ç»Ÿã€‚

## æ‚¨å°†å­¦åˆ°ä»€ä¹ˆ

å®Œæˆåï¼Œå…¶ä»–å¼€å‘è€…å°†èƒ½å¤Ÿç›´æ¥ä»Hubä½¿ç”¨æ‚¨çš„æ ¸å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```python
import torch

from kernels import get_kernel


optimized_kernel = get_kernel("your-username/optimized-kernel")


some_input = torch.randn((10, 10), device="cuda")


out = optimized_kernel.my_kernel_function(some_input)

print(out)

```

æ›´æƒ³çœ‹è§†é¢‘ï¼Ÿè¯·æŸ¥çœ‹ä¸æœ¬æŒ‡å—é…å¥—çš„YouTubeè§†é¢‘ã€‚

è®©æˆ‘ä»¬å¼€å§‹å§ï¼ğŸš€

## ç¬¬ä¸€éƒ¨åˆ†ï¼šç°ä»£CUDAæ ¸å‡½æ•°å‰–æ

è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªå°†å›¾åƒä»RGBè½¬æ¢ä¸ºç°åº¦çš„å®ç”¨æ ¸å‡½æ•°ã€‚æ­¤ç¤ºä¾‹ä½¿ç”¨PyTorchçš„ç°ä»£C++ APIå°†æˆ‘ä»¬çš„å‡½æ•°æ³¨å†Œä¸ºä¸€æµçš„åŸç”Ÿæ“ä½œç¬¦ã€‚

### æ­¥éª¤1ï¼šé¡¹ç›®ç»“æ„

æ¸…æ™°ã€å¯é¢„æµ‹çš„ç»“æ„æ˜¯è‰¯å¥½é¡¹ç›®çš„åŸºç¡€ã€‚Hugging Face Kernel BuilderæœŸæœ›æ‚¨çš„æ–‡ä»¶æŒ‰å¦‚ä¸‹æ–¹å¼ç»„ç»‡ï¼š

```bash
img2gray/
â”œâ”€â”€ build.toml
â”œâ”€â”€ csrc
â”‚   â””â”€â”€ img2gray.cu
â”œâ”€â”€ flake.nix
â””â”€â”€ torch-ext
    â”œâ”€â”€ torch_binding.cpp
    â”œâ”€â”€ torch_binding.h
    â””â”€â”€ img2gray
        â””â”€â”€ __init__.py

```

- `build.toml`ï¼šé¡¹ç›®æ¸…å•ï¼›å®ƒæ˜¯æ„å»ºè¿‡ç¨‹çš„æ ¸å¿ƒã€‚
- `csrc/`ï¼šæ‚¨çš„åŸå§‹CUDAæºä»£ç æ‰€åœ¨ï¼ŒGPUé­”æ³•å‘ç”Ÿçš„åœ°æ–¹ã€‚
- `flake.nix`ï¼šå®ç°å®Œç¾å¯é‡ç°*æ„å»ºç¯å¢ƒçš„å…³é”®ã€‚
- `torch-ext/img2gray/`ï¼šåŸå§‹PyTorchæ“ä½œç¬¦çš„PythonåŒ…è£…å™¨ã€‚

### æ­¥éª¤2ï¼š`build.toml`æ¸…å•

æ­¤æ–‡ä»¶åè°ƒæ•´ä¸ªæ„å»ºè¿‡ç¨‹ã€‚å®ƒå‘Šè¯‰`kernel-builder`è¦ç¼–è¯‘ä»€ä¹ˆä»¥åŠå„éƒ¨åˆ†å¦‚ä½•è¿æ¥ã€‚

```toml

[general]
name = "img2gray"
universal = false


[torch]
src = [
  "torch-ext/torch_binding.cpp",
  "torch-ext/torch_binding.h"
]


[kernel.img2gray]
backend = "cuda"
depends = ["torch"] 
src = [
    "csrc/img2gray.cu",
]

```

### æ­¥éª¤3ï¼š`flake.nix`å¯é‡ç°æ€§æ–‡ä»¶

ä¸ºç¡®ä¿ä»»ä½•äººéƒ½èƒ½åœ¨ä»»ä½•æœºå™¨ä¸Šæ„å»ºæ‚¨çš„æ ¸å‡½æ•°ï¼Œæˆ‘ä»¬ä½¿ç”¨`flake.nix`æ–‡ä»¶ã€‚å®ƒé”å®š`kernel-builder`åŠå…¶ä¾èµ–é¡¹çš„ç¡®åˆ‡ç‰ˆæœ¬ï¼Œæ¶ˆé™¤â€œåœ¨æˆ‘æœºå™¨ä¸Šèƒ½è¿è¡Œâ€çš„é—®é¢˜ã€‚

```nix

{
  description = "Flake for img2gray kernel";

  inputs = {
    kernel-builder.url = "github:huggingface/kernel-builder";
  };

  outputs =
    {
      self,
      kernel-builder,
    }:
    kernel-builder.lib.genFlakeOutputs {
      path = ./.;
      rev = self.shortRev or self.dirtyShortRev or self.lastModifiedDate;
    };
}

```

### æ­¥éª¤4ï¼šç¼–å†™CUDAæ ¸å‡½æ•°

ç°åœ¨å¼€å§‹ç¼–å†™GPUä»£ç ã€‚åœ¨`csrc/img2gray.cu`ä¸­ï¼Œæˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªä½¿ç”¨2Dçº¿ç¨‹ç½‘æ ¼çš„æ ¸å‡½æ•°â€”â€”è¿™æ˜¯å¤„ç†å›¾åƒçš„ä¸€ç§è‡ªç„¶ä¸”é«˜æ•ˆçš„æ–¹å¼ã€‚

```cpp

#include <cstdint>
#include <torch/torch.h>


__global__ void img2gray_kernel(const uint8_t* input, uint8_t* output, int width, int height) {
    int x = blockIdx.x * blockDim.x + threadIdx.x;
    int y = blockIdx.y * blockDim.y + threadIdx.y;

    if (x < width && y < height) {
        int idx = (y * width + x) * 3; 
        uint8_t r = input[idx];
        uint8_t g = input[idx + 1];
        uint8_t b = input[idx + 2];

        
        uint8_t gray = static_cast<uint8_t>(0.21f * r + 0.72f * g + 0.07f * b);
        output[y * width + x] = gray;
    }
}


void img2gray_cuda(torch::Tensor const &input, torch::Tensor &output) {
    const int width = input.size(1);
    const int height = input.size(0);

    
    const dim3 blockSize(16, 16);
    const dim3 gridSize((width + blockSize.x - 1) / blockSize.x, (height + blockSize.y - 1) / blockSize.y);

    img2gray_kernel<<<gridSize, blockSize>>>(
        input.data_ptr<uint8_t>(),
        output.data_ptr<uint8_t>(),
        width,
        height
    );
}

```

### æ­¥éª¤5ï¼šæ³¨å†ŒåŸç”ŸPyTorchæ“ä½œç¬¦

è¿™æ˜¯æœ€é‡è¦çš„ä¸€æ­¥ã€‚æˆ‘ä»¬ä¸ä»…ä»…æ˜¯ç»‘å®šåˆ°Pythonï¼›æˆ‘ä»¬æ˜¯å°†æˆ‘ä»¬çš„å‡½æ•°æ³¨å†Œä¸ºåŸç”ŸPyTorchæ“ä½œç¬¦ã€‚è¿™ä½¿å…¶æˆä¸ºPyTorchç”Ÿæ€ç³»ç»Ÿä¸­çš„ä¸€ç­‰å…¬æ°‘ï¼Œåœ¨`torch.ops`å‘½åç©ºé—´ä¸‹å¯è§ã€‚

æ–‡ä»¶`torch-ext/torch_binding.cpp`å¤„ç†æ­¤æ³¨å†Œã€‚

```cpp

#include <torch/library.h>
#include "registration.h" 
#include "torch_binding.h" 

TORCH_LIBRARY_EXPAND(TORCH_EXTENSION_NAME, ops) {
  ops.def("img2gray(Tensor input, Tensor! output) -> ()");
  ops.impl("img2gray", torch::kCUDA, &img2gray_cuda);
}

REGISTER_EXTENSION(TORCH_EXTENSION_NAME)

```

ç®€å•æ¥è¯´ï¼Œ`TORCH_LIBRARY_EXPAND`å…è®¸æˆ‘ä»¬ä»¥ä¸€ç§æœªæ¥å¯ä»¥è½»æ¾æ‰©å±•æˆ–ä¿®æ”¹çš„æ–¹å¼å®šä¹‰æˆ‘ä»¬çš„æ“ä½œç¬¦ã€‚

#### ä¸ºä½•è¿™å¾ˆé‡è¦

è¿™ç§æ–¹æ³•è‡³å…³é‡è¦ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªåŸå› ï¼š

- ä¸`torch.compile`çš„å…¼å®¹æ€§ï¼šé€šè¿‡è¿™ç§æ–¹å¼æ³¨å†Œæˆ‘ä»¬çš„æ ¸å‡½æ•°ï¼Œ`torch.compile`å¯ä»¥â€œçœ‹åˆ°â€å®ƒã€‚è¿™ä½¿å¾—PyTorchèƒ½å¤Ÿå°†æ‚¨çš„è‡ªå®šä¹‰æ“ä½œç¬¦èåˆåˆ°æ›´å¤§çš„è®¡ç®—å›¾ä¸­ï¼Œæœ€å°åŒ–å¼€é”€å¹¶æœ€å¤§åŒ–æ€§èƒ½ã€‚è¿™æ˜¯è®©æ‚¨çš„è‡ªå®šä¹‰ä»£ç ä¸PyTorchæ›´å¹¿æ³›çš„æ€§èƒ½ç”Ÿæ€ç³»ç»Ÿæ— ç¼åä½œçš„å…³é”®ã€‚
- ç¡¬ä»¶ç‰¹å®šå®ç°ï¼šæ­¤ç³»ç»Ÿå…è®¸æ‚¨ä¸ºåŒä¸€æ“ä½œç¬¦æä¾›ä¸åŒçš„åç«¯ã€‚æ‚¨å¯ä»¥æ·»åŠ å¦ä¸€ä¸ªæŒ‡å‘C++ CPUå‡½æ•°çš„`TORCH_LIBRARY_IMPL(img2gray, CPU, ...)`å—ã€‚ç„¶åï¼ŒPyTorchçš„è°ƒåº¦å™¨å°†æ ¹æ®è¾“å…¥å¼ é‡çš„è®¾å¤‡è‡ªåŠ¨è°ƒç”¨æ­£ç¡®çš„å®ç°ï¼ˆCUDAæˆ–CPUï¼‰ï¼Œä½¿æ‚¨çš„ä»£ç åŠŸèƒ½å¼ºå¤§ä¸”å¯ç§»æ¤ã€‚

### è®¾ç½®`__init__.py`åŒ…è£…å™¨

åœ¨`torch-ext/img2gray/`ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª`__init__.py`æ–‡ä»¶æ¥ä½¿æ­¤ç›®å½•æˆä¸ºPythonåŒ…ï¼Œå¹¶ä»¥ç”¨æˆ·å‹å¥½çš„æ–¹å¼å…¬å¼€æˆ‘ä»¬çš„è‡ªå®šä¹‰æ“ä½œç¬¦ã€‚

`_ops`æ¨¡å—æ˜¯ç”±kernel-builderæ ¹æ®æ¨¡æ¿è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä¸ºæ‚¨çš„æ³¨å†ŒC++å‡½æ•°æä¾›æ ‡å‡†å‘½åç©ºé—´ã€‚

```python

import torch

from ._ops import ops


def img2gray(input: torch.Tensor) -> torch.Tensor:
    
    height, width, channels = input.shape
    assert channels == 3, "Input image must have 3 channels (RGB)"

    output = torch.empty((height, width), device=input.device, dtype=input.dtype)
    ops.img2gray(input, output)

    return output

```

### æ­¥éª¤6ï¼šæ„å»ºæ ¸å‡½æ•°

ç°åœ¨æˆ‘ä»¬çš„æ ¸å‡½æ•°åŠå…¶ç»‘å®šå·²å‡†å¤‡å°±ç»ªï¼Œæ˜¯æ—¶å€™æ„å»ºå®ƒä»¬äº†ã€‚`kernel-builder`å·¥å…·ç®€åŒ–äº†è¿™ä¸ªè¿‡ç¨‹ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨å•ä¸ªå‘½ä»¤`nix build . -L`æ„å»ºæ‚¨çš„æ ¸å‡½æ•°ï¼›ç„¶è€Œï¼Œä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›ä¸€ä¸ªæ›´å¿«ã€æ›´è¿­ä»£çš„å·¥ä½œæµç¨‹ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`nix develop`å‘½ä»¤è¿›å…¥ä¸€ä¸ªé¢„è£…äº†æ‰€æœ‰å¿…è¦ä¾èµ–é¡¹çš„å¼€å‘ç¯å¢ƒã€‚

æ›´å…·ä½“åœ°è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©è¦ä½¿ç”¨çš„ç¡®åˆ‡CUDAå’ŒPyTorchç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼Œè¦ä¸ºPyTorch 2.7å’ŒCUDA 12.6æ„å»ºæˆ‘ä»¬çš„æ ¸å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

#### è¿›å…¥Nix Shell

```bash

nix develop .

```

è¯·æ³¨æ„ï¼Œä¸Šé¢çš„ `devShell` åç§°å¯ä»¥è§£è¯»ä¸ºï¼š

```nix
nix develop .
                        â”‚       â”‚         â”‚       â”‚
                        â”‚       â”‚         â”‚       â””â”€â”€â”€ æ¶æ„ï¼šx86_64 (Linux)
                        â”‚       â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CUDA ç‰ˆæœ¬ï¼š12.6
                        â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ C++ ABIï¼šcxx11
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Torch ç‰ˆæœ¬ï¼š2.7

```

æ­¤æ—¶ï¼Œæˆ‘ä»¬å°†è¿›å…¥ä¸€ä¸ªå·²å®‰è£…æ‰€æœ‰ä¾èµ–é¡¹çš„ Nix shell ä¸­ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ­¤ç‰¹å®šæ¶æ„æ„å»ºå†…æ ¸å¹¶è¿›è¡Œæµ‹è¯•ã€‚ç¨åï¼Œåœ¨åˆ†å‘æœ€ç»ˆç‰ˆæœ¬çš„å†…æ ¸ä¹‹å‰ï¼Œæˆ‘ä»¬å°†å¤„ç†å¤šç§æ¶æ„ã€‚

#### è®¾ç½®æ„å»ºäº§ç‰©

```bash
build2cmake generate-torch build.toml


```

æ­¤å‘½ä»¤ä¼šåˆ›å»ºä¸€äº›ç”¨äºæ„å»ºå†…æ ¸çš„æ–‡ä»¶ï¼š`CMakeLists.txt`ã€`pyproject.toml`ã€`setup.py` å’Œä¸€ä¸ª `cmake` ç›®å½•ã€‚`CMakeLists.txt` æ–‡ä»¶æ˜¯ CMake æ„å»ºå†…æ ¸çš„ä¸»è¦å…¥å£ç‚¹ã€‚

#### åˆ›å»º Python è™šæ‹Ÿç¯å¢ƒ

```bash
python -m venv .venv
source .venv/bin/activate

```

ç°åœ¨ï¼Œæ‚¨å¯ä»¥åœ¨å¯ç¼–è¾‘æ¨¡å¼ä¸‹å®‰è£…å†…æ ¸ã€‚

#### ç¼–è¯‘å†…æ ¸å¹¶å®‰è£… Python åŒ…

```bash
pip install --no-build-isolation -e .

```

ğŸ™Œ å¤ªæ£’äº†ï¼æˆ‘ä»¬ç°åœ¨æ‹¥æœ‰äº†ä¸€ä¸ªéµå¾ª PyTorch ç»‘å®šæœ€ä½³å®è·µçš„è‡ªå®šä¹‰æ„å»ºå†…æ ¸ï¼Œå¹¶ä¸”æ„å»ºè¿‡ç¨‹å®Œå…¨å¯é‡ç°ã€‚

#### å¼€å‘å‘¨æœŸ

ä¸ºäº†ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä¸€ä¸ªç®€å•çš„æµ‹è¯•æ¥æ£€æŸ¥å†…æ ¸æ˜¯å¦å·²æ³¨å†Œå¹¶æŒ‰é¢„æœŸå·¥ä½œã€‚å¦‚æœä¸è¡Œï¼Œæ‚¨å¯ä»¥é€šè¿‡ç¼–è¾‘æºæ–‡ä»¶å¹¶é‡å¤æ„å»ºæ¥è¿­ä»£ï¼Œé‡ç”¨æ‚¨åˆ›å»ºçš„ nix ç¯å¢ƒã€‚

```python

import torch
import img2gray

from PIL import Image
import numpy as np

print(dir(img2gray))

img = Image.open("kernel-builder-logo-color.png").convert("RGB")
img = np.array(img)
img_tensor = torch.from_numpy(img).cuda()
print(img_tensor.shape)  

gray_tensor = img2gray.img2gray(img_tensor).squeeze()
print(gray_tensor.shape)  


gray_img = Image.fromarray(gray_tensor.cpu().numpy().astype(np.uint8), mode="L")
gray_img.save("kernel-builder-logo-gray.png")

```

### æ­¥éª¤ 7ï¼šä¸ä¸–ç•Œåˆ†äº«

ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå¯å·¥ä½œçš„å†…æ ¸ï¼Œæ˜¯æ—¶å€™ä¸å…¶ä»–å¼€å‘è€…å’Œä¸–ç•Œåˆ†äº«äº†ï¼

åœ¨åˆ†äº«ä¹‹å‰ï¼Œæˆ‘ä»¬æƒ³åšä¸€ä»¶å°äº‹ï¼Œé‚£å°±æ˜¯æ¸…ç†æ„å»ºè¿‡ç¨‹ä¸­ç”Ÿæˆçš„æ‰€æœ‰å¼€å‘äº§ç‰©ï¼Œä»¥é¿å…ä¸Šä¼ ä¸å¿…è¦çš„æ–‡ä»¶ã€‚

```bash
build2cmake clean build.toml

```

#### ä¸ºæ‰€æœ‰ PyTorch å’Œ CUDA ç‰ˆæœ¬æ„å»ºå†…æ ¸

ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸ºç‰¹å®šç‰ˆæœ¬çš„ PyTorch å’Œ CUDA æ„å»ºäº†å†…æ ¸ã€‚ç„¶è€Œï¼Œä¸ºäº†è®©æ›´å¹¿æ³›çš„å—ä¼—èƒ½å¤Ÿä½¿ç”¨ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ‰€æœ‰æ”¯æŒçš„ç‰ˆæœ¬æ„å»ºå®ƒã€‚`kernel-builder` å·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®Œæˆè¿™é¡¹å·¥ä½œã€‚

è¿™ä¹Ÿæ˜¯ **åˆè§„å†…æ ¸** æ¦‚å¿µå‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚åˆè§„å†…æ ¸æ˜¯æŒ‡èƒ½å¤Ÿä¸ºæ‰€æœ‰æ”¯æŒçš„ PyTorch å’Œ CUDA ç‰ˆæœ¬æ„å»ºå’Œè¿è¡Œçš„å†…æ ¸ã€‚é€šå¸¸ï¼Œè¿™éœ€è¦è‡ªå®šä¹‰é…ç½®ï¼›ä½†åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œ`kernel-builder` å·¥å…·å°†è‡ªåŠ¨å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚

```bash


nix build . -L

```

è¿™ä¸ªè¿‡ç¨‹å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼Œå› ä¸ºå®ƒå°†ä¸ºæ‰€æœ‰æ”¯æŒçš„ PyTorch å’Œ CUDA ç‰ˆæœ¬æ„å»ºå†…æ ¸ã€‚è¾“å‡ºå°†ä½äº `result` ç›®å½•ä¸­ã€‚

kernel-builder å›¢é˜Ÿç§¯æç»´æŠ¤ **æ”¯æŒçš„æ„å»ºå˜ä½“**ï¼Œä½¿å…¶ä¸æœ€æ–°çš„ PyTorch å’Œ CUDA ç‰ˆæœ¬ä¿æŒåŒæ­¥ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒè¾ƒæ—§çš„ç‰ˆæœ¬ä»¥å®ç°æ›´å¹¿æ³›çš„å…¼å®¹æ€§ã€‚

æœ€åä¸€æ­¥æ˜¯å°†ç»“æœç§»åŠ¨åˆ°é¢„æœŸçš„ `build` ç›®å½•ä¸­ï¼ˆè¿™æ˜¯ `kernels` åº“å°†æŸ¥æ‰¾å®ƒä»¬çš„ä½ç½®ï¼‰ã€‚

```bash
mkdir -p build
rsync -av --delete --chmod=Du+w,Fu+w result/ build/

```

#### æ¨é€åˆ° Hugging Face Hub

å°†æ„å»ºäº§ç‰©æ¨é€åˆ° Hub å°†ä½¿å…¶ä»–å¼€å‘è€…èƒ½å¤Ÿè½»æ¾ä½¿ç”¨æ‚¨çš„å†…æ ¸ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨ **ä¸Šä¸€ç¯‡æ–‡ç« ** ä¸­çœ‹åˆ°çš„é‚£æ ·ã€‚

é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼š

```bash
hf repo create img2gray

```

ç¡®ä¿æ‚¨å·²ä½¿ç”¨ `huggingface-cli login` ç™»å½•åˆ° Hugging Face Hubã€‚

ç°åœ¨ï¼Œåœ¨æ‚¨çš„é¡¹ç›®ç›®å½•ä¸­ï¼Œå°†æ‚¨çš„é¡¹ç›®è¿æ¥åˆ°æ–°ä»“åº“å¹¶æ¨é€æ‚¨çš„ä»£ç ï¼š

```bash

git init
git remote add origin https://huggingface.co/<your-username>/img2gray


git pull origin main
git lfs install
git checkout -b main


git lfs track "*.so"



git add \
  build/ csrc/ \
  torch-ext/torch_binding.cpp torch-ext/torch_binding.h torch-ext/img2gray \
  flake.nix flake.lock build.toml

git commit -m "feat: Created a compliant img2gray kernel"
git push -u origin main

```

å¤ªæ£’äº†ï¼æ‚¨çš„å†…æ ¸ç°åœ¨å·²åœ¨ Hugging Face Hub ä¸Šï¼Œå¯ä¾›ä»–äººä½¿ç”¨ï¼Œå¹¶ä¸”å®Œå…¨å…¼å®¹ `kernels` åº“ã€‚æˆ‘ä»¬çš„å†…æ ¸åŠå…¶æ‰€æœ‰æ„å»ºå˜ä½“ç°åœ¨å¯ä»¥åœ¨ `drbh/img2gray` æ‰¾åˆ°ã€‚

### æ­¥éª¤ 8ï¼šåŠ è½½å’Œæµ‹è¯•æ‚¨çš„è‡ªå®šä¹‰ç®—å­

ä½¿ç”¨ `kernels` åº“ï¼Œæ‚¨ä¸éœ€è¦ä»¥ä¼ ç»Ÿæ–¹å¼â€œå®‰è£…â€å†…æ ¸ã€‚æ‚¨å¯ä»¥ç›´æ¥ä»å…¶ Hub ä»“åº“åŠ è½½å®ƒï¼Œè¿™å°†è‡ªåŠ¨æ³¨å†Œæ–°çš„ç®—å­ã€‚

```python









import torch
from PIL import Image
import numpy as np
from kernels import get_kernel



img2gray_lib = get_kernel("drbh/img2gray")

img = Image.open("kernel-builder-logo-color.png").convert("RGB")
img = np.array(img)
img_tensor = torch.from_numpy(img).cuda()
print(img_tensor.shape)  

gray_tensor = img2gray_lib.img2gray(img_tensor).squeeze()
print(gray_tensor.shape)  


gray_img = Image.fromarray(gray_tensor.cpu().numpy().astype(np.uint8), mode="L")
gray_img.save("kernel-builder-logo-gray2.png")

```

## ç¬¬äºŒéƒ¨åˆ†ï¼šä»ä¸€ä¸ªå†…æ ¸åˆ°å¤šä¸ªå†…æ ¸ï¼šè§£å†³ç”Ÿäº§æŒ‘æˆ˜

ä¸€æ—¦æ‚¨æ‹¥æœ‰äº†ä¸€ä¸ªéšæ—¶å¯ç”¨çš„å†…æ ¸ï¼Œæ‚¨å¯ä»¥åšä¸€äº›äº‹æƒ…æ¥ä½¿å…¶æ›´æ˜“äºéƒ¨ç½²ã€‚æˆ‘ä»¬å°†è®¨è®ºä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ä½œä¸ºä¸€ç§å·¥å…·ï¼Œä»¥ä¾¿åœ¨ä¸ç ´åå†…æ ¸ä¸‹æ¸¸ä½¿ç”¨çš„æƒ…å†µä¸‹è¿›è¡Œ API æ›´æ”¹ã€‚ä¹‹åï¼Œæˆ‘ä»¬å°†æ€»ç»“å¦‚ä½•ä¸ºæ‚¨çš„å†…æ ¸åˆ¶ä½œ Python wheel åŒ…ã€‚

### å†…æ ¸ç‰ˆæœ¬

æ‚¨å¯èƒ½åœ¨ä¸€æ®µæ—¶é—´åå†³å®šæ›´æ–°æ‚¨çš„å†…æ ¸ã€‚ä¹Ÿè®¸æ‚¨æ‰¾åˆ°äº†æé«˜æ€§èƒ½çš„æ–°æ–¹æ³•ï¼Œæˆ–è€…æ‚¨å¯èƒ½å¸Œæœ›æ‰©å±•å†…æ ¸çš„åŠŸèƒ½ã€‚æŸäº›æ›´æ”¹å°†è¦æ±‚æ‚¨æ›´æ”¹å†…æ ¸çš„ APIã€‚ä¾‹å¦‚ï¼Œè¾ƒæ–°çš„ç‰ˆæœ¬å¯èƒ½ä¼šå‘æŸä¸ªå…¬å…±å‡½æ•°æ·»åŠ ä¸€ä¸ªæ–°çš„å¿…éœ€å‚æ•°ã€‚è¿™å¯¹ä¸‹æ¸¸ç”¨æˆ·æ¥è¯´å¯èƒ½ä¸å¤ªæ–¹ä¾¿ï¼Œå› ä¸ºä»–ä»¬çš„ä»£ç ä¼šä¸­æ–­ï¼Œç›´åˆ°ä»–ä»¬æ·»åŠ è¿™ä¸ªæ–°å‚æ•°ã€‚

å†…æ ¸çš„ä¸‹æ¸¸ç”¨æˆ·å¯ä»¥é€šè¿‡å°†æ‰€ä½¿ç”¨çš„å†…æ ¸å›ºå®šåˆ°ç‰¹å®šç‰ˆæœ¬æ¥é¿å…æ­¤ç±»ä¸­æ–­ã€‚ä¾‹å¦‚ï¼Œç”±äºæ¯ä¸ª Hub ä»“åº“ä¹Ÿæ˜¯ä¸€ä¸ª Git ä»“åº“ï¼Œä»–ä»¬å¯ä»¥ä½¿ç”¨ Git æäº¤çš„çŸ­å“ˆå¸Œå€¼å°†å†…æ ¸å›ºå®šåˆ°æŸä¸ªä¿®è®¢ç‰ˆæœ¬ï¼š

```python
from kernels import get_kernel
img2gray_lib = get_kernel("drbh/img2gray", revision="4148918")

```

ä½¿ç”¨ Git çŸ­å“ˆå¸Œå€¼å°†å‡å°‘ä¸­æ–­çš„å¯èƒ½æ€§ï¼›ç„¶è€Œï¼Œå®ƒéš¾ä»¥è§£è¯»ï¼Œå¹¶ä¸”ä¸å…è®¸åœ¨ç‰ˆæœ¬èŒƒå›´å†…è¿›è¡Œä¼˜é›…çš„å‡çº§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å»ºè®®ä¸º Hub å†…æ ¸ä½¿ç”¨ç†Ÿæ‚‰çš„ **è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶** ç³»ç»Ÿã€‚ä¸ºå†…æ ¸æ·»åŠ ç‰ˆæœ¬å¾ˆå®¹æ˜“ï¼šæ‚¨åªéœ€æ·»åŠ ä¸€ä¸ªå½¢å¼ä¸º `vx.y.z` çš„ Git æ ‡ç­¾ï¼Œå…¶ä¸­ `x.y.z` æ˜¯ç‰ˆæœ¬å·ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå†…æ ¸çš„å½“å‰ç‰ˆæœ¬æ˜¯ 1.1.2ï¼Œæ‚¨å¯ä»¥å°†å…¶æ ‡è®°ä¸º `v1.1.2`ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `get_kernel` è·å–è¯¥ç‰ˆæœ¬ï¼š

```python
from kernels import get_kernel
img2gray_lib = get_kernel("drbh/img2gray", revision="v1.1.2")

```

ç‰ˆæœ¬æ§åˆ¶ç»“åˆç‰ˆæœ¬èŒƒå›´ä¼šå˜å¾—æ›´åŠ å¼ºå¤§ã€‚åœ¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ä¸­ï¼Œç‰ˆæœ¬ `1.y.z` çš„å…¬å…± API åœ¨åç»­çš„ `x` å’Œ `y` ç‰ˆæœ¬ä¸­ä¸å¾—æœ‰å‘åä¸å…¼å®¹çš„æ›´æ”¹ã€‚å› æ­¤ï¼Œå¦‚æœåœ¨ç¼–å†™ä»£ç æ—¶å†…æ ¸çš„ç‰ˆæœ¬æ˜¯ `1.1.2`ï¼Œæ‚¨å¯ä»¥è¦æ±‚ç‰ˆæœ¬è‡³å°‘ä¸º `1.1.2`ï¼Œä½†å°äº `2.0.0`ï¼š

```python
from kernels import get_kernel
img2gray_lib = get_kernel("drbh/img2gray", version=">=1.1.2,<2")

```

è¿™å°†ç¡®ä¿ä»£ç å§‹ç»ˆä» `1.y.z` ç³»åˆ—ä¸­è·å–æœ€æ–°çš„å†…æ ¸ã€‚ç‰ˆæœ¬èŒƒå›´å¯ä»¥æ˜¯ Python é£æ ¼çš„ç‰ˆæœ¬è¯´æ˜ç¬¦ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ `huggingface-cli` **æ ‡è®°** ä¸€ä¸ªç‰ˆæœ¬ï¼š

```bash
$ huggingface-cli tag drbh/img2gray v1.1.2

```

#### é”å®šå†…æ ¸

åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œä½ å¯èƒ½å¸Œæœ›å…¨å±€åè°ƒå†…æ ¸ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ª `get_kernel` è°ƒç”¨ä¸­å•ç‹¬å¤„ç†ã€‚æ­¤å¤–ï¼Œé”å®šå†…æ ¸é€šå¸¸å¾ˆæœ‰ç”¨ï¼Œè¿™æ ·æ‰€æœ‰ç”¨æˆ·éƒ½ä½¿ç”¨ç›¸åŒçš„å†…æ ¸ç‰ˆæœ¬ï¼Œè¿™æœ‰åŠ©äºå¤„ç†é”™è¯¯æŠ¥å‘Šã€‚

`kernels` åº“æä¾›äº†ä¸€ç§åœ¨é¡¹ç›®çº§åˆ«ç®¡ç†å†…æ ¸çš„å¥½æ–¹æ³•ã€‚ä¸ºæ­¤ï¼Œè¯·åœ¨ä½ çš„é¡¹ç›®çš„æ„å»ºç³»ç»Ÿè¦æ±‚ä¸­æ·»åŠ  `kernels` åŒ…ï¼Œå³åœ¨ `pyproject.toml` æ–‡ä»¶ä¸­ã€‚å®Œæˆåï¼Œä½ å¯ä»¥åœ¨ `tool.kernels` éƒ¨åˆ†æŒ‡å®šé¡¹ç›®çš„å†…æ ¸è¦æ±‚ï¼š

```toml
[build-system]
requires = ["kernels", "setuptools"]
build-backend = "setuptools.build_meta"

[tool.kernels.dependencies]
"drbh/img2gray" = ">=0.1.2,<0.2.0"

```

ç‰ˆæœ¬å¯ä»¥ä½¿ç”¨ä¸ Python ä¾èµ–é¡¹ç›¸åŒç±»å‹çš„ç‰ˆæœ¬è¯´æ˜ç¬¦æ¥æŒ‡å®šã€‚è¿™æ˜¯ç‰ˆæœ¬æ ‡ç­¾ï¼ˆv a.b.cï¼‰æ´¾ä¸Šç”¨åœºçš„å¦ä¸€ä¸ªåœ°æ–¹â€”â€”`kernels` å°†ä½¿ç”¨ä»“åº“çš„ç‰ˆæœ¬æ ‡ç­¾æ¥æŸ¥è¯¢å¯ç”¨çš„ç‰ˆæœ¬ã€‚åœ¨ `pyproject.toml` ä¸­æŒ‡å®šå†…æ ¸åï¼Œä½ å¯ä»¥ä½¿ç”¨ `kernels` å‘½ä»¤è¡Œå·¥å…·å°†å…¶é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ã€‚è¯¥å·¥å…·æ˜¯ `kernels` Python åŒ…çš„ä¸€éƒ¨åˆ†ï¼š

```bash
$ kernels lock .

```

è¿™ä¼šç”Ÿæˆä¸€ä¸ª `kernels.lock` æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸ `pyproject.toml` ä¸­æŒ‡å®šçš„è¾¹ç•Œå…¼å®¹çš„æœ€æ–°å†…æ ¸ç‰ˆæœ¬ã€‚`kernels.lock` åº”æäº¤åˆ°é¡¹ç›®çš„ Git ä»“åº“ï¼Œä»¥ä¾¿é¡¹ç›®çš„æ¯ä¸ªç”¨æˆ·éƒ½èƒ½è·å¾—é”å®šçš„å†…æ ¸ç‰ˆæœ¬ã€‚å½“å‘å¸ƒæ–°çš„å†…æ ¸ç‰ˆæœ¬æ—¶ï¼Œä½ å¯ä»¥å†æ¬¡è¿è¡Œ `kernels lock` æ¥æ›´æ–°é”å®šæ–‡ä»¶ã€‚

è¦åœ¨é¡¹ç›®ä¸­å®Œå…¨å®ç°é”å®šå†…æ ¸ï¼Œä½ è¿˜éœ€è¦æœ€åä¸€æ­¥ã€‚`get_locked_kernel` æ˜¯ `get_kernel` çš„å¯¹åº”å‡½æ•°ï¼Œå®ƒä½¿ç”¨é”å®šçš„å†…æ ¸ã€‚å› æ­¤ï¼Œè¦ä½¿ç”¨é”å®šçš„å†…æ ¸ï¼Œè¯·å°†æ‰€æœ‰å‡ºç°çš„ `get_kernel` æ›¿æ¢ä¸º `get_locked_kernel`ï¼š

```python
from kernels import get_kernel
img2gray_lib = get_locked_kernel("drbh/img2gray")

```

å°±æ˜¯è¿™æ ·ï¼ç°åœ¨ï¼Œé¡¹ç›®ä¸­æ¯æ¬¡è°ƒç”¨ `get_locked_kernel("drbh/img2gray")` éƒ½å°†ä½¿ç”¨ `kernels.lock` ä¸­æŒ‡å®šçš„ç‰ˆæœ¬ã€‚

### é¢„ä¸‹è½½é”å®šçš„å†…æ ¸

å¦‚æœæœ¬åœ° Hub ç¼“å­˜ä¸­ä¸å¯ç”¨ï¼Œ`get_locked_kernel` å‡½æ•°å°†ä¸‹è½½å†…æ ¸ã€‚è¿™å¯¹äºä½ ä¸å¸Œæœ›åœ¨è¿è¡Œæ—¶ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶çš„åº”ç”¨ç¨‹åºæ¥è¯´å¹¶ä¸ç†æƒ³ã€‚ä¾‹å¦‚ï¼Œå½“ä½ ä¸ºåº”ç”¨ç¨‹åºæ„å»º Docker é•œåƒæ—¶ï¼Œé€šå¸¸å¸Œæœ›å†…æ ¸ä¸åº”ç”¨ç¨‹åºä¸€èµ·å­˜å‚¨åœ¨é•œåƒä¸­ã€‚è¿™å¯ä»¥é€šè¿‡ä¸¤ä¸ªç®€å•çš„æ­¥éª¤å®Œæˆã€‚

é¦–å…ˆï¼Œä½¿ç”¨ `load_kernel` å‡½æ•°ä»£æ›¿ `get_locked_kernel`ï¼š

```python
from kernels import get_kernel
img2gray_lib = load_kernel("drbh/img2gray")

```

é¡¾åæ€ä¹‰ï¼Œæ­¤å‡½æ•°åªä¼šåŠ è½½å†…æ ¸ï¼Œå®ƒ**æ°¸è¿œä¸ä¼š**å°è¯•ä» Hub ä¸‹è½½å†…æ ¸ã€‚å¦‚æœå†…æ ¸åœ¨æœ¬åœ°ä¸å¯ç”¨ï¼Œ`load_kernel` å°†å¼•å‘å¼‚å¸¸ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•ä½¿å†…æ ¸åœ¨æœ¬åœ°å¯ç”¨å‘¢ï¼Ÿ`kernels` å·¥å…·å¯ä»¥æ»¡è¶³ä½ çš„éœ€æ±‚ï¼è¿è¡Œ `kernels download .` å°†ä¸‹è½½ `kernels.lock` ä¸­æŒ‡å®šçš„å†…æ ¸ã€‚å› æ­¤ï¼Œä¾‹å¦‚ï¼Œåœ¨ Docker å®¹å™¨ä¸­ï¼Œä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªæ­¥éª¤ï¼š

```docker
RUN kernels download /path/to/your/project

```

å†…æ ¸å°±ä¼šè¢«çƒ˜ç„™åˆ°ä½ çš„ Docker é•œåƒä¸­ã€‚

å†…æ ¸ä½¿ç”¨æ ‡å‡†çš„ Hugging Face ç¼“å­˜ï¼Œå› æ­¤æ‰€æœ‰ `HF_HOME` ç¼“å­˜è§„åˆ™éƒ½é€‚ç”¨ã€‚

### åˆ›å»ºä¼ ç»Ÿ Python Wheels

æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½¿ç”¨ `kernels` åŒ…ä» Hub ä¸‹è½½å†…æ ¸ã€‚è¿™æœ‰å¾ˆå¤šå¥½å¤„ï¼š

- `kernels` æ”¯æŒåœ¨å•ä¸ª Python è¿›ç¨‹ä¸­åŠ è½½åŒä¸€å†…æ ¸çš„å¤šä¸ªç‰ˆæœ¬ã€‚
- `kernels` ä¼šè‡ªåŠ¨ä¸‹è½½ä¸ä½ çš„ç¯å¢ƒçš„ CUDA å’Œ Torch ç‰ˆæœ¬å…¼å®¹çš„å†…æ ¸ç‰ˆæœ¬ã€‚
- ä½ å°†è·å¾— Hub çš„æ‰€æœ‰å¥½å¤„ï¼šåˆ†æã€é—®é¢˜è·Ÿè¸ªã€æ‹‰å–è¯·æ±‚ã€åˆ†æ”¯ç­‰ã€‚
- Hub å’Œ `kernel-builder` æä¾›äº†æ¥æºå’Œå¯é‡ç°æ€§ï¼Œç”¨æˆ·å¯ä»¥æŸ¥çœ‹å†…æ ¸çš„æºä»£ç å†å²è®°å½•ï¼Œå¹¶åœ¨ç›¸åŒçš„æ„å»ºç¯å¢ƒä¸­é‡æ–°æ„å»ºä»¥è¿›è¡ŒéªŒè¯ã€‚

è¯è™½å¦‚æ­¤ï¼Œæœ‰äº›é¡¹ç›®å¯èƒ½éœ€è¦å°†å†…æ ¸ä½œä¸º wheels éƒ¨ç½²ã€‚`kernels` å·¥å…·ä¸ºæ­¤æä¾›äº†ä¸€ä¸ªç®€å•çš„è§£å†³æ–¹æ¡ˆã€‚ä½ å¯ä»¥ä½¿ç”¨å•ä¸ªå‘½ä»¤å°†ä»»ä½• Hub å†…æ ¸è½¬æ¢ä¸ºä¸€ç»„ wheelsï¼š

```bash
$ kernels to-wheel drbh/img2grey 1.1.2
â˜¸ img2grey-1.1.2+torch27cu128cxx11-cp39-abi3-manylinux_2_28_x86_64.whl
â˜¸ img2grey-1.1.2+torch26cu124cxx11-cp39-abi3-manylinux_2_28_x86_64.whl
â˜¸ img2grey-1.1.2+torch26cu126cxx11-cp39-abi3-manylinux_2_28_x86_64.whl
â˜¸ img2grey-1.1.2+torch27cu126cxx11-cp39-abi3-manylinux_2_28_x86_64.whl
â˜¸ img2grey-1.1.2+torch26cu126cxx98-cp39-abi3-manylinux_2_28_x86_64.whl
â˜¸ img2grey-1.1.2+torch27cu128cxx11-cp39-abi3-manylinux_2_28_aarch64.whl
â˜¸ img2grey-1.1.2+torch26cu126cxx98-cp39-abi3-manylinux_2_28_aarch64.whl
â˜¸ img2grey-1.1.2+torch27cu126cxx11-cp39-abi3-manylinux_2_28_aarch64.whl
â˜¸ img2grey-1.1.2+torch26cu126cxx11-cp39-abi3-manylinux_2_28_aarch64.whl
â˜¸ img2grey-1.1.2+torch26cu118cxx98-cp39-abi3-manylinux_2_28_x86_64.whl
â˜¸ img2grey-1.1.2+torch26cu124cxx98-cp39-abi3-manylinux_2_28_x86_64.whl
â˜¸ img2grey-1.1.2+torch26cu118cxx11-cp39-abi3-manylinux_2_28_x86_64.whl
â˜¸ img2grey-1.1.2+torch27cu118cxx11-cp39-abi3-manylinux_2_28_x86_64.whl

```

è¿™äº› wheels ä¸­çš„æ¯ä¸€ä¸ªéƒ½å°†åƒä»»ä½•å…¶ä»– Python wheel ä¸€æ ·è¿è¡Œï¼šå¯ä»¥ä½¿ç”¨ç®€å•çš„ `import img2grey` å¯¼å…¥å†…æ ¸ã€‚

# ç»“è®º

æœ¬æŒ‡å—å¼•å¯¼ä½ å®Œæˆäº†ç”Ÿäº§å°±ç»ªçš„ CUDA å†…æ ¸çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚ä½ å·²ç»äº†è§£äº†å¦‚ä½•ä»å¤´å¼€å§‹æ„å»ºè‡ªå®šä¹‰å†…æ ¸ï¼Œå°†å…¶æ³¨å†Œä¸ºåŸç”Ÿ PyTorch æ“ä½œç¬¦ï¼Œå¹¶åœ¨ Hugging Face Hub ä¸Šä¸ç¤¾åŒºåˆ†äº«ã€‚æˆ‘ä»¬è¿˜æ¢è®¨äº†ç‰ˆæœ¬æ§åˆ¶ã€ä¾èµ–ç®¡ç†å’Œéƒ¨ç½²çš„æœ€ä½³å®è·µï¼Œç¡®ä¿ä½ çš„å·¥ä½œæ—¢å¼ºå¤§åˆæ˜“äºç»´æŠ¤ã€‚

æˆ‘ä»¬ç›¸ä¿¡ï¼Œå¼€æ”¾å’Œåä½œçš„å¼€å‘æ˜¯åˆ›æ–°çš„å…³é”®ã€‚æ—¢ç„¶ä½ å·²ç»æŒæ¡äº†æ„å»ºè‡ªå·±çš„é«˜æ€§èƒ½å†…æ ¸çš„å·¥å…·å’ŒçŸ¥è¯†ï¼Œæˆ‘ä»¬å¾ˆé«˜å…´çœ‹åˆ°ä½ çš„åˆ›é€ ï¼æˆ‘ä»¬è¯šæŒšåœ°é‚€è¯·ä½ åœ¨ **Kernel Hub** æˆ–æˆ‘ä»¬çš„ **kernel-builder GitHub ä»“åº“** å’Œ **kernels GitHub ä»“åº“** ä¸­åˆ†äº«ä½ çš„å·¥ä½œã€æé—®å¹¶å¼€å§‹è®¨è®ºã€‚æ— è®ºä½ æ˜¯ç»éªŒä¸°å¯Œçš„å¼€å‘è€…è¿˜æ˜¯åˆšåˆšèµ·æ­¥ï¼Œç¤¾åŒºéƒ½ä¼šåœ¨è¿™é‡Œæ”¯æŒä½ ã€‚

è®©æˆ‘ä»¬å¼€å§‹æ„å»ºå§ï¼ğŸš€

---

> æœ¬æ–‡ç”±AIè‡ªåŠ¨ç¿»è¯‘ï¼ŒåŸæ–‡é“¾æ¥ï¼š[From Zero to GPU: A Guide to Building and Scaling Production-Ready CUDA Kernels](https://huggingface.co/blog/kernel-builder)
> 
> ç¿»è¯‘æ—¶é—´ï¼š2026-02-14 04:14
