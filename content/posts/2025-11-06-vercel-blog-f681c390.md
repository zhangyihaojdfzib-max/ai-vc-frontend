---
title: CVE-2025-48985：Vercel AI SDK 输入验证绕过漏洞
title_original: 'CVE-2025-48985: Input Validation Bypass on AI SDK - Vercel'
date: '2025-11-06'
source: Vercel Blog
source_url: https://vercel.com/changelog/cve-2025-48985-input-validation-bypass-on-ai-sdk
author: ''
summary: Vercel AI SDK 的提示词转换管道中存在一个低严重性安全漏洞，该漏洞源于 `convert-to-language-model-prompt.ts`
  文件中 URL 到数据映射的索引错位问题。在处理混合的受支持和不受支持URL时，过滤操作可能导致下载数据被错误关联，使得来自不受支持URL的字节数据被映射到受支持URL的位置，从而绕过文件类型白名单和内容验证机制。这主要影响
  `generateText()` 和 `streamText()` 等接受图像或文件输入的函数。漏洞已在 5.0.52 和 6.0.0-beta.* 版本中修复，建议用户及时升级。
categories:
- AI基础设施
tags:
- 安全漏洞
- Vercel AI SDK
- 输入验证
- CVE-2025-48985
- AI安全
draft: false
translated_at: '2026-02-02T04:23:51.910936'
---

Vercel AI SDK 中存在一个低严重性安全漏洞，已通过负责任的方式披露，并在 5.0.52 和 6.0.0-beta.* 版本中修复。该问题可能导致用户在上传文件时绕过文件类型白名单。

建议 Vercel 客户升级至最新版本。更多详情请阅读下文。

## 摘要

Vercel AI SDK 的提示词转换管道中存在一个漏洞，不当的 URL 到数据映射可能允许攻击者在同一提示词中，用任意下载的字节数据替换不同的受支持 URL。该漏洞发生在 `convert-to-language-model-prompt.ts` 文件中，当过滤下载结果时，可能导致 `downloadedFiles` 数组与原始的 `plannedDownloads` 数组之间索引错位。

## 影响

在处理混合的受支持和不受支持的 URL 时，过滤操作会移除受支持 URL 对应的空条目，导致剩余的下载数据被错误地关联到不同的 URL 键。这使得来自不受支持 URL 的字节数据被映射到受支持 URL 的位置，从而允许攻击者在绕过基于 URL 的信任和内容验证机制的情况下注入任意内容。

这影响了大多数接受图像或文件作为输入的方法，除非在 SDK 外部实现了明确的数据验证。具体而言，是 `generateText()` 和 `streamText()` 函数。

## 解决方案

该问题已通过以下方式解决：在过滤掉空文件之前先进行文件映射，以保留正确的索引。修复版本为：
- 5.0.52
- 6.0.0-beta.*

5.0.52

6.0.0-beta.*

## 临时解决方案

- 在 SDK 外部实现自定义的文件类型验证逻辑。

在 SDK 外部实现自定义的文件类型验证逻辑。

## 致谢

感谢 @aphantom 负责任地披露此漏洞。

## 参考链接

- https://github.com/vercel/ai/issues/8881
- https://www.cve.org/CVERecord?id=CVE-2025-48985

https://github.com/vercel/ai/issues/8881

https://www.cve.org/CVERecord?id=CVE-2025-48985

---

> 本文由AI自动翻译，原文链接：[CVE-2025-48985: Input Validation Bypass on AI SDK - Vercel](https://vercel.com/changelog/cve-2025-48985-input-validation-bypass-on-ai-sdk)
> 
> 翻译时间：2026-02-02 04:23
