---
title: SEEDS：生成式AI高效量化天气预报不确定性
title_original: Generative AI to quantify uncertainty in weather forecasting
date: '2024-03-29'
source: Google AI Blog
source_url: http://blog.research.google/2024/03/generative-ai-to-quantify-uncertainty.html
author: null
summary: Google Research团队提出可扩展集合包络扩散采样器（SEEDS），这是一种基于生成式AI的概率扩散模型，能以传统物理模拟成本的一小部分，大规模生成高质量的天气预报集合。该技术解决了传统集合预报计算成本高、成员数量有限的问题，尤其擅长量化罕见极端天气事件的不确定性，为应急管理和气候科学提供了高效可靠的新工具。
categories:
- AI研究
tags:
- 生成式AI
- 天气预报
- 不确定性量化
- 扩散模型
- 气候科学
draft: false
---

生成式AI量化天气预报中的不确定性
2024年3月29日
Lizao (Larry) Li，软件工程师，与Rob Carver，研究科学家，Google Research
快速链接
准确的天气预报能直接影响人们的生活，从帮助做出日常决策（例如为一天的活动准备行装），到指导紧急行动（例如在危险天气条件下保护人员）。随着气候变化，准确及时的天气预报将愈发重要。认识到这一点，我们在Google一直投资于天气和气候研究，以帮助确保未来的预报技术能够满足对可靠天气信息的需求。我们近期的一些创新包括MetNet-3（Google对未来24小时的高分辨率预报）和GraphCast（一个可以预测未来10天天气的天气模型）。
天气本质上是随机的。为了量化不确定性，传统方法依赖基于物理的模拟来生成预报集合。然而，生成一个大型集合的计算成本很高，以便能够准确识别和描述罕见及极端天气事件。
考虑到这一点，我们很高兴宣布我们旨在加速天气预报进展的最新创新——可扩展集合包络扩散采样器（SEEDS），该成果近期发表于《科学进展》。SEEDS是一个生成式AI模型，能够以传统基于物理的预报模型成本的一小部分，高效地大规模生成天气预报集合。这项技术为天气和气候科学开辟了新的机遇，并且是概率扩散模型（一种推动近期媒体生成进展的生成式AI技术）在天气和气候预报领域的首批应用之一。
对概率预报的需求：蝴蝶效应
1972年12月，在华盛顿特区举行的美国科学促进会会议上，麻省理工学院气象学教授埃德·洛伦兹发表了题为“巴西一只蝴蝶扇动翅膀是否会在德克萨斯州引发龙卷风？”的演讲，这促成了“蝴蝶效应”一词的流行。他的演讲基于其1963年发表的具有里程碑意义的早期论文，在那篇论文中，他探讨了“超长期天气预报”的可行性，并描述了初始条件中的误差在数值天气预报模型随时间积分时如何呈指数增长。这种指数级的误差增长，被称为混沌，导致了一个确定性的可预测性极限，限制了单个预报在决策中的使用，因为它们无法量化天气条件固有的不确定性。这在预报极端天气事件（如飓风、热浪或洪水）时尤其成问题。
认识到确定性预报的局限性，世界各地的气象机构会发布概率预报。这类预报基于确定性预报的集合，每个集合成员都是通过在初始条件中加入合成噪声以及在物理过程中加入随机性来生成的。利用天气模型中快速的误差增长率，集合中的预报被设计成彼此不同：初始不确定性经过调整，以生成尽可能不同的运行结果，而天气模型中的随机过程在模型运行期间引入了额外的差异。通过对集合中的所有预报进行平均可以减轻误差增长，而预报集合中的变异性则量化了天气条件的不确定性。
虽然有效，但生成这些概率预报的计算成本很高。它们需要在大型超级计算机上多次运行高度复杂的数值天气模型。因此，许多业务天气预报在每个预报周期只能负担生成约10-50个集合成员。这对于关注罕见但高影响天气事件可能性的用户来说是个问题，因为评估几天后的此类事件通常需要大得多的集合。例如，要预测发生概率为1%的事件，且相对误差小于10%，就需要一个包含10,000个成员的集合。量化此类极端事件的概率可能很有用，例如用于应急管理准备或能源交易。
SEEDS：AI赋能的技术进步
在上述论文中，我们提出了可扩展集合包络扩散采样器（SEEDS），这是一种用于天气预报集合生成的生成式AI技术。SEEDS基于去噪扩散概率模型，这是一种部分由Google Research开创的先进生成式AI方法。
SEEDS可以根据业务数值天气预报系统提供的一到两个预报作为条件，生成一个大型集合。生成的集合不仅能产生看似合理的、类似真实天气的预报，而且在技能指标（如秩直方图、均方根误差和连续分级概率评分）上匹配或超越了基于物理的集合。特别是，生成的集合能为预报分布的尾部（如±2σ和±3σ天气事件）分配更准确的可能性。最重要的是，与超级计算机进行预报所需的数小时计算时间相比，该模型的计算成本可以忽略不计。在Google Cloud TPUv3-32实例上，其吞吐量为每3分钟256个集合成员（分辨率为2°），并且可以通过部署更多加速器轻松扩展到更高的吞吐量。
生成看似合理的天气预报
生成式AI以生成非常详细的图像和视频而闻名。这一特性对于生成与合理天气模式一致的集合预报特别有用，这最终能为下游应用带来最大的附加值。正如洛伦兹指出的，“它们产生的[天气预报]图应该看起来像真实的天气图。”下图将SEEDS的预报与美国业务天气预报系统（全球集合预报系统，GEFS）在2022年欧洲热浪期间某个特定日期的预报进行了对比。我们还将结果与高斯模型的预报进行了比较，该模型预测每个位置每个大气场的单变量均值和标准差，这是一种常见且计算高效但较不复杂的数据驱动方法。这个高斯模型旨在描述逐点后处理的输出，它忽略了相关性并将每个网格点视为独立的随机变量。相比之下，真实的天气图具有详细的相关结构。
由于SEEDS直接模拟大气状态的联合分布，它真实地捕捉了空间协方差以及对流层中位势高度与平均海平面气压之间的相关性，这两者密切相关，并且是天气预报员通常用于评估和验证预报的指标。平均海平面气压的梯度驱动着地表风，而对流层中位势高度的梯度则产生了推动大规模天气模式的高层风。
下图中显示的SEEDS生成样本（图Ca–Ch）展示了葡萄牙以西的一个位势槽，其空间结构与美国业务预报或基于观测的再分析中发现的结构相似。尽管高斯模型充分预测了边缘单变量分布，但它未能捕捉跨场或空间相关性。

这阻碍了评估这些异常现象可能对来自北非的热空气入侵产生的影响，而此类入侵会加剧欧洲的热浪。

**更准确地覆盖极端事件**

下方展示了2022年7月14日当地时间凌晨1点极端高温事件期间，里斯本附近2米高度气温与整层大气水汽总量的联合分布。我们使用了2022年7月7日发布的7天预报。对于每个图表，我们使用SEEDS生成了包含16,384个成员的集合。ERA5再分析数据观测到的天气事件用星号表示。业务集合预报也一并显示，其中方块表示用于生成集合的种子预报，三角形表示集合中的其他成员。

根据美国业务集合预报，在事件发生七天前，观测到的事件可能性极低，其31个成员中没有一个预测到接近观测值的近地面高温。事实上，根据高斯核密度估计计算的事件概率低于1%，这意味着成员数少于100的集合不太可能包含与此事件同样极端的预报。相比之下，SEEDS集合能够从两个种子预报进行外推，提供一个可能天气状态的包络线，从而在统计上更好地覆盖该事件。这使得量化事件发生的概率以及采样事件可能发生的天气型态成为可能。具体而言，我们高度可扩展的生成方法能够创建非常庞大的集合，通过为任何用户定义的诊断指标提供超过给定阈值的天气状态样本，来刻画极其罕见的事件。

**结论与未来展望**

SEEDS利用生成式AI的力量，以更快的速度生成可与美国业务预报系统相媲美的集合预报。本文报告的结果仅需来自业务系统的2个种子预报，而当前版本的业务系统会生成31个预报。这催生了一种混合预报系统：先用基于物理的模型计算少量天气轨迹作为种子，再使用扩散模型来更高效地生成额外的预报。这种方法为当前业务天气预报范式提供了一种替代方案，统计模拟器所节省的计算资源可用于提高基于物理模型的分辨率或增加预报发布频率。

我们相信，SEENDS只是未来几年AI加速业务数值天气预报进展的众多方式之一。我们希望这次关于生成式AI在天气预报模拟和后处理中效用的展示，能够推动其在气候风险评估等研究领域的应用，在这些领域生成大量气候预测集合对于准确量化未来气候的不确定性至关重要。

**致谢**

所有SEEDS作者——Lizao Li、Rob Carver、Ignacio Lopez-Gomez、Fei Sha和John Anderson——共同撰写了这篇博文，Carla Bromberg担任项目负责人。我们也感谢Tom Small设计了动画。我们在Google Research的同事为SEEDS工作提供了宝贵的建议。在此，我们感谢Leonardo Zepeda-Núñez、Zhong Yi Wan、Stephan Rasp、Stephan Hoyer和Tapio Schneider的投入和有益讨论。我们感谢Tyler Russell提供的额外技术项目管理，以及Alex Merose在数据协调和支持方面的工作。我们也感谢Cenk Gazen、Shreya Agrawal和Jason Hickey在SEEDS工作早期阶段的讨论。

---

> 本文由AI自动翻译，原文链接：[Generative AI to quantify uncertainty in weather forecasting](http://blog.research.google/2024/03/generative-ai-to-quantify-uncertainty.html)
> 
> 翻译时间：2026-01-04 23:23
